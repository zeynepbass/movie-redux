!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).GDeviceAPI={})}(this,(function(e){"use strict";var t,r,n,a,o,i,s,_,l,E,u,c,R,T,p,A,F,d,f,m,h,S,g,N,B,C;function L(e){return e}function M(e,t,r){return e<<16|t<<8|r}function O(e){return e>>>8&255}function I(e){return e>>>16&255}function U(e){return 255&e}function D(t){switch(t){case e.FormatTypeFlags.F32:case e.FormatTypeFlags.U32:case e.FormatTypeFlags.S32:return 4;case e.FormatTypeFlags.U16:case e.FormatTypeFlags.S16:case e.FormatTypeFlags.F16:return 2;case e.FormatTypeFlags.U8:case e.FormatTypeFlags.S8:return 1;default:throw Error("whoops")}}function G(e){return D(I(e))}function P(e){return D(I(e))*O(e)}function v(t){var r=U(t);if(r&e.FormatFlags.Depth)return e.SamplerFormatKind.Depth;if(r&e.FormatFlags.Normalized)return e.SamplerFormatKind.Float;var n=I(t);if(n===e.FormatTypeFlags.F16||n===e.FormatTypeFlags.F32)return e.SamplerFormatKind.Float;if(n===e.FormatTypeFlags.U8||n===e.FormatTypeFlags.U16||n===e.FormatTypeFlags.U32)return e.SamplerFormatKind.Uint;if(n===e.FormatTypeFlags.S8||n===e.FormatTypeFlags.S16||n===e.FormatTypeFlags.S32)return e.SamplerFormatKind.Sint;throw Error("whoops")}function y(e,t){if(void 0===t&&(t=""),!e)throw Error("Assert fail: ".concat(t))}function b(e){if(null!=e)return e;throw Error("Missing object")}function x(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}function X(e,t){e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a}function w(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}function W(e,t,r,n){return void 0===n&&(n=1),{r:e,g:t,b:r,a:n}}e.GL=void 0,(t=e.GL||(e.GL={}))[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.ALWAYS=519]="ALWAYS",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.GEQUAL=518]="GEQUAL",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",t[t.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",t[t.RGBA32F_EXT=34836]="RGBA32F_EXT",t[t.RGB32F_EXT=34837]="RGB32F_EXT",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",t[t.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",t[t.MIN_EXT=32775]="MIN_EXT",t[t.MAX_EXT=32776]="MAX_EXT",t[t.SRGB_EXT=35904]="SRGB_EXT",t[t.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",t[t.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",t[t.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",t[t.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",t[t.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",t[t.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",t[t.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",t[t.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",t[t.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",t[t.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",t[t.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",t[t.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",t[t.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",t[t.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",t[t.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",t[t.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",t[t.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",t[t.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",t[t.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",t[t.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",t[t.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",t[t.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",t[t.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",t[t.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",t[t.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",t[t.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",t[t.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",t[t.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",t[t.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",t[t.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",t[t.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",t[t.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",t[t.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",t[t.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",t[t.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",t[t.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",t[t.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e.ResourceType=void 0,(r=e.ResourceType||(e.ResourceType={}))[r.Buffer=0]="Buffer",r[r.Texture=1]="Texture",r[r.RenderTarget=2]="RenderTarget",r[r.Sampler=3]="Sampler",r[r.Program=4]="Program",r[r.Bindings=5]="Bindings",r[r.InputLayout=6]="InputLayout",r[r.RenderPipeline=7]="RenderPipeline",r[r.ComputePipeline=8]="ComputePipeline",r[r.Readback=9]="Readback",r[r.QueryPool=10]="QueryPool",e.CompareFunction=void 0,(n=e.CompareFunction||(e.CompareFunction={}))[n.NEVER=512]="NEVER",n[n.LESS=513]="LESS",n[n.EQUAL=514]="EQUAL",n[n.LEQUAL=515]="LEQUAL",n[n.GREATER=516]="GREATER",n[n.NOTEQUAL=517]="NOTEQUAL",n[n.GEQUAL=518]="GEQUAL",n[n.ALWAYS=519]="ALWAYS",e.FrontFace=void 0,(a=e.FrontFace||(e.FrontFace={}))[a.CCW=2305]="CCW",a[a.CW=2304]="CW",e.CullMode=void 0,(o=e.CullMode||(e.CullMode={}))[o.NONE=0]="NONE",o[o.FRONT=1]="FRONT",o[o.BACK=2]="BACK",o[o.FRONT_AND_BACK=3]="FRONT_AND_BACK",e.BlendFactor=void 0,(i=e.BlendFactor||(e.BlendFactor={}))[i.ZERO=0]="ZERO",i[i.ONE=1]="ONE",i[i.SRC=768]="SRC",i[i.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",i[i.DST=774]="DST",i[i.ONE_MINUS_DST=775]="ONE_MINUS_DST",i[i.SRC_ALPHA=770]="SRC_ALPHA",i[i.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",i[i.DST_ALPHA=772]="DST_ALPHA",i[i.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",i[i.CONST=32769]="CONST",i[i.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",i[i.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e.BlendMode=void 0,(s=e.BlendMode||(e.BlendMode={}))[s.ADD=32774]="ADD",s[s.SUBSTRACT=32778]="SUBSTRACT",s[s.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",s[s.MIN=32775]="MIN",s[s.MAX=32776]="MAX",e.AddressMode=void 0,(_=e.AddressMode||(e.AddressMode={}))[_.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",_[_.REPEAT=1]="REPEAT",_[_.MIRRORED_REPEAT=2]="MIRRORED_REPEAT",e.FilterMode=void 0,(l=e.FilterMode||(e.FilterMode={}))[l.POINT=0]="POINT",l[l.BILINEAR=1]="BILINEAR",e.MipmapFilterMode=void 0,(E=e.MipmapFilterMode||(e.MipmapFilterMode={}))[E.NO_MIP=0]="NO_MIP",E[E.NEAREST=1]="NEAREST",E[E.LINEAR=2]="LINEAR",e.PrimitiveTopology=void 0,(u=e.PrimitiveTopology||(e.PrimitiveTopology={}))[u.POINTS=0]="POINTS",u[u.TRIANGLES=1]="TRIANGLES",u[u.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",u[u.LINES=3]="LINES",u[u.LINE_STRIP=4]="LINE_STRIP",e.BufferUsage=void 0,(c=e.BufferUsage||(e.BufferUsage={}))[c.MAP_READ=1]="MAP_READ",c[c.MAP_WRITE=2]="MAP_WRITE",c[c.COPY_SRC=4]="COPY_SRC",c[c.COPY_DST=8]="COPY_DST",c[c.INDEX=16]="INDEX",c[c.VERTEX=32]="VERTEX",c[c.UNIFORM=64]="UNIFORM",c[c.STORAGE=128]="STORAGE",c[c.INDIRECT=256]="INDIRECT",c[c.QUERY_RESOLVE=512]="QUERY_RESOLVE",e.BufferFrequencyHint=void 0,(R=e.BufferFrequencyHint||(e.BufferFrequencyHint={}))[R.STATIC=1]="STATIC",R[R.DYNAMIC=2]="DYNAMIC",e.VertexStepMode=void 0,(T=e.VertexStepMode||(e.VertexStepMode={}))[T.VERTEX=1]="VERTEX",T[T.INSTANCE=2]="INSTANCE",e.TextureEvent=void 0,(e.TextureEvent||(e.TextureEvent={})).LOADED="loaded",e.TextureDimension=void 0,(p=e.TextureDimension||(e.TextureDimension={}))[p.TEXTURE_2D=0]="TEXTURE_2D",p[p.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",p[p.TEXTURE_3D=2]="TEXTURE_3D",p[p.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP",e.TextureUsage=void 0,(A=e.TextureUsage||(e.TextureUsage={}))[A.SAMPLED=1]="SAMPLED",A[A.RENDER_TARGET=2]="RENDER_TARGET",e.ChannelWriteMask=void 0,(F=e.ChannelWriteMask||(e.ChannelWriteMask={}))[F.NONE=0]="NONE",F[F.RED=1]="RED",F[F.GREEN=2]="GREEN",F[F.BLUE=4]="BLUE",F[F.ALPHA=8]="ALPHA",F[F.RGB=7]="RGB",F[F.ALL=15]="ALL",e.StencilOp=void 0,(d=e.StencilOp||(e.StencilOp={}))[d.KEEP=7680]="KEEP",d[d.ZERO=0]="ZERO",d[d.REPLACE=7681]="REPLACE",d[d.INVERT=5386]="INVERT",d[d.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",d[d.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",d[d.INCREMENT_WRAP=34055]="INCREMENT_WRAP",d[d.DECREMENT_WRAP=34056]="DECREMENT_WRAP",e.SamplerFormatKind=void 0,(f=e.SamplerFormatKind||(e.SamplerFormatKind={}))[f.Float=0]="Float",f[f.Uint=1]="Uint",f[f.Sint=2]="Sint",f[f.Depth=3]="Depth",e.ViewportOrigin=void 0,(m=e.ViewportOrigin||(e.ViewportOrigin={}))[m.LOWER_LEFT=0]="LOWER_LEFT",m[m.UPPER_LEFT=1]="UPPER_LEFT",e.ClipSpaceNearZ=void 0,(h=e.ClipSpaceNearZ||(e.ClipSpaceNearZ={}))[h.NEGATIVE_ONE=0]="NEGATIVE_ONE",h[h.ZERO=1]="ZERO",e.QueryPoolType=void 0,(S=e.QueryPoolType||(e.QueryPoolType={}))[S.OcclusionConservative=0]="OcclusionConservative",e.FormatTypeFlags=void 0,(g=e.FormatTypeFlags||(e.FormatTypeFlags={}))[g.U8=1]="U8",g[g.U16=2]="U16",g[g.U32=3]="U32",g[g.S8=4]="S8",g[g.S16=5]="S16",g[g.S32=6]="S32",g[g.F16=7]="F16",g[g.F32=8]="F32",g[g.BC1=65]="BC1",g[g.BC2=66]="BC2",g[g.BC3=67]="BC3",g[g.BC4_UNORM=68]="BC4_UNORM",g[g.BC4_SNORM=69]="BC4_SNORM",g[g.BC5_UNORM=70]="BC5_UNORM",g[g.BC5_SNORM=71]="BC5_SNORM",g[g.U16_PACKED_5551=97]="U16_PACKED_5551",g[g.U16_PACKED_565=98]="U16_PACKED_565",g[g.D24=129]="D24",g[g.D32F=130]="D32F",g[g.D24S8=131]="D24S8",g[g.D32FS8=132]="D32FS8",e.FormatCompFlags=void 0,(N=e.FormatCompFlags||(e.FormatCompFlags={}))[N.R=1]="R",N[N.RG=2]="RG",N[N.RGB=3]="RGB",N[N.RGBA=4]="RGBA",N[N.A=5]="A",e.FormatFlags=void 0,(B=e.FormatFlags||(e.FormatFlags={}))[B.None=0]="None",B[B.Normalized=1]="Normalized",B[B.sRGB=2]="sRGB",B[B.Depth=4]="Depth",B[B.Stencil=8]="Stencil",B[B.RenderTarget=16]="RenderTarget",B[B.Luminance=32]="Luminance",e.Format=void 0,(C=e.Format||(e.Format={}))[C.ALPHA=M(e.FormatTypeFlags.U8,e.FormatCompFlags.A,e.FormatFlags.None)]="ALPHA",C[C.U8_LUMINANCE=M(e.FormatTypeFlags.U8,e.FormatCompFlags.A,e.FormatFlags.Luminance)]="U8_LUMINANCE",C[C.F16_LUMINANCE=M(e.FormatTypeFlags.F16,e.FormatCompFlags.A,e.FormatFlags.Luminance)]="F16_LUMINANCE",C[C.F32_LUMINANCE=M(e.FormatTypeFlags.F32,e.FormatCompFlags.A,e.FormatFlags.Luminance)]="F32_LUMINANCE",C[C.F16_R=M(e.FormatTypeFlags.F16,e.FormatCompFlags.R,e.FormatFlags.None)]="F16_R",C[C.F16_RG=M(e.FormatTypeFlags.F16,e.FormatCompFlags.RG,e.FormatFlags.None)]="F16_RG",C[C.F16_RGB=M(e.FormatTypeFlags.F16,e.FormatCompFlags.RGB,e.FormatFlags.None)]="F16_RGB",C[C.F16_RGBA=M(e.FormatTypeFlags.F16,e.FormatCompFlags.RGBA,e.FormatFlags.None)]="F16_RGBA",C[C.F32_R=M(e.FormatTypeFlags.F32,e.FormatCompFlags.R,e.FormatFlags.None)]="F32_R",C[C.F32_RG=M(e.FormatTypeFlags.F32,e.FormatCompFlags.RG,e.FormatFlags.None)]="F32_RG",C[C.F32_RGB=M(e.FormatTypeFlags.F32,e.FormatCompFlags.RGB,e.FormatFlags.None)]="F32_RGB",C[C.F32_RGBA=M(e.FormatTypeFlags.F32,e.FormatCompFlags.RGBA,e.FormatFlags.None)]="F32_RGBA",C[C.U8_R=M(e.FormatTypeFlags.U8,e.FormatCompFlags.R,e.FormatFlags.None)]="U8_R",C[C.U8_R_NORM=M(e.FormatTypeFlags.U8,e.FormatCompFlags.R,e.FormatFlags.Normalized)]="U8_R_NORM",C[C.U8_RG=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RG,e.FormatFlags.None)]="U8_RG",C[C.U8_RG_NORM=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RG,e.FormatFlags.Normalized)]="U8_RG_NORM",C[C.U8_RGB=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RGB,e.FormatFlags.None)]="U8_RGB",C[C.U8_RGB_NORM=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RGB,e.FormatFlags.Normalized)]="U8_RGB_NORM",C[C.U8_RGB_SRGB=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RGB,e.FormatFlags.sRGB|e.FormatFlags.Normalized)]="U8_RGB_SRGB",C[C.U8_RGBA=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RGBA,e.FormatFlags.None)]="U8_RGBA",C[C.U8_RGBA_NORM=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized)]="U8_RGBA_NORM",C[C.U8_RGBA_SRGB=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RGBA,e.FormatFlags.sRGB|e.FormatFlags.Normalized)]="U8_RGBA_SRGB",C[C.U16_R=M(e.FormatTypeFlags.U16,e.FormatCompFlags.R,e.FormatFlags.None)]="U16_R",C[C.U16_R_NORM=M(e.FormatTypeFlags.U16,e.FormatCompFlags.R,e.FormatFlags.Normalized)]="U16_R_NORM",C[C.U16_RG_NORM=M(e.FormatTypeFlags.U16,e.FormatCompFlags.RG,e.FormatFlags.Normalized)]="U16_RG_NORM",C[C.U16_RGBA_NORM=M(e.FormatTypeFlags.U16,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized)]="U16_RGBA_NORM",C[C.U16_RGB=M(e.FormatTypeFlags.U16,e.FormatCompFlags.RGB,e.FormatFlags.None)]="U16_RGB",C[C.U32_R=M(e.FormatTypeFlags.U32,e.FormatCompFlags.R,e.FormatFlags.None)]="U32_R",C[C.U32_RG=M(e.FormatTypeFlags.U32,e.FormatCompFlags.RG,e.FormatFlags.None)]="U32_RG",C[C.S8_R=M(e.FormatTypeFlags.S8,e.FormatCompFlags.R,e.FormatFlags.None)]="S8_R",C[C.S8_R_NORM=M(e.FormatTypeFlags.S8,e.FormatCompFlags.R,e.FormatFlags.Normalized)]="S8_R_NORM",C[C.S8_RG_NORM=M(e.FormatTypeFlags.S8,e.FormatCompFlags.RG,e.FormatFlags.Normalized)]="S8_RG_NORM",C[C.S8_RGB_NORM=M(e.FormatTypeFlags.S8,e.FormatCompFlags.RGB,e.FormatFlags.Normalized)]="S8_RGB_NORM",C[C.S8_RGBA_NORM=M(e.FormatTypeFlags.S8,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized)]="S8_RGBA_NORM",C[C.S16_R=M(e.FormatTypeFlags.S16,e.FormatCompFlags.R,e.FormatFlags.None)]="S16_R",C[C.S16_RG=M(e.FormatTypeFlags.S16,e.FormatCompFlags.RG,e.FormatFlags.None)]="S16_RG",C[C.S16_RG_NORM=M(e.FormatTypeFlags.S16,e.FormatCompFlags.RG,e.FormatFlags.Normalized)]="S16_RG_NORM",C[C.S16_RGB_NORM=M(e.FormatTypeFlags.S16,e.FormatCompFlags.RGB,e.FormatFlags.Normalized)]="S16_RGB_NORM",C[C.S16_RGBA=M(e.FormatTypeFlags.S16,e.FormatCompFlags.RGBA,e.FormatFlags.None)]="S16_RGBA",C[C.S16_RGBA_NORM=M(e.FormatTypeFlags.S16,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized)]="S16_RGBA_NORM",C[C.S32_R=M(e.FormatTypeFlags.S32,e.FormatCompFlags.R,e.FormatFlags.None)]="S32_R",C[C.U16_RGBA_5551=M(e.FormatTypeFlags.U16_PACKED_5551,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized)]="U16_RGBA_5551",C[C.U16_RGB_565=M(e.FormatTypeFlags.U16_PACKED_565,e.FormatCompFlags.RGB,e.FormatFlags.Normalized)]="U16_RGB_565",C[C.BC1=M(e.FormatTypeFlags.BC1,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized)]="BC1",C[C.BC1_SRGB=M(e.FormatTypeFlags.BC1,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized|e.FormatFlags.sRGB)]="BC1_SRGB",C[C.BC2=M(e.FormatTypeFlags.BC2,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized)]="BC2",C[C.BC2_SRGB=M(e.FormatTypeFlags.BC2,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized|e.FormatFlags.sRGB)]="BC2_SRGB",C[C.BC3=M(e.FormatTypeFlags.BC3,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized)]="BC3",C[C.BC3_SRGB=M(e.FormatTypeFlags.BC3,e.FormatCompFlags.RGBA,e.FormatFlags.Normalized|e.FormatFlags.sRGB)]="BC3_SRGB",C[C.BC4_UNORM=M(e.FormatTypeFlags.BC4_UNORM,e.FormatCompFlags.R,e.FormatFlags.Normalized)]="BC4_UNORM",C[C.BC4_SNORM=M(e.FormatTypeFlags.BC4_SNORM,e.FormatCompFlags.R,e.FormatFlags.Normalized)]="BC4_SNORM",C[C.BC5_UNORM=M(e.FormatTypeFlags.BC5_UNORM,e.FormatCompFlags.RG,e.FormatFlags.Normalized)]="BC5_UNORM",C[C.BC5_SNORM=M(e.FormatTypeFlags.BC5_SNORM,e.FormatCompFlags.RG,e.FormatFlags.Normalized)]="BC5_SNORM",C[C.D24=M(e.FormatTypeFlags.D24,e.FormatCompFlags.R,e.FormatFlags.Depth)]="D24",C[C.D24_S8=M(e.FormatTypeFlags.D24S8,e.FormatCompFlags.RG,e.FormatFlags.Depth|e.FormatFlags.Stencil)]="D24_S8",C[C.D32F=M(e.FormatTypeFlags.D32F,e.FormatCompFlags.R,e.FormatFlags.Depth)]="D32F",C[C.D32F_S8=M(e.FormatTypeFlags.D32FS8,e.FormatCompFlags.RG,e.FormatFlags.Depth|e.FormatFlags.Stencil)]="D32F_S8",C[C.U8_RGB_RT=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RGB,e.FormatFlags.RenderTarget|e.FormatFlags.Normalized)]="U8_RGB_RT",C[C.U8_RGBA_RT=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RGBA,e.FormatFlags.RenderTarget|e.FormatFlags.Normalized)]="U8_RGBA_RT",C[C.U8_RGBA_RT_SRGB=M(e.FormatTypeFlags.U8,e.FormatCompFlags.RGBA,e.FormatFlags.RenderTarget|e.FormatFlags.Normalized|e.FormatFlags.sRGB)]="U8_RGBA_RT_SRGB";var H=W(0,0,0,0),V=W(0,0,0,1),k=W(1,1,1,0),Y=W(1,1,1,1),K=!0;function q(t,r){if(void 0===r&&(r=K),!r)return t;switch(t){case e.CompareFunction.LESS:return e.CompareFunction.GREATER;case e.CompareFunction.LEQUAL:return e.CompareFunction.GEQUAL;case e.CompareFunction.GEQUAL:return e.CompareFunction.LEQUAL;case e.CompareFunction.GREATER:return e.CompareFunction.LESS;default:return t}}function z(e){return!(!e||0!=(e&e-1))}function Z(e,t){return null!=e?e:t}function Q(e){return void 0===e?null:e}function j(e,t){var r=t-1;return e+r&~r}function $(e,t,r){for(var n=0,a=e.length;a>n;){var o=n+(a-n>>>1);0>r(t,e[o])?a=o:n=o+1}return n}function J(e,t){for(var r=Array(e),n=0;e>n;n++)r[n]=t();return r}function ee(e,t){return void 0===t&&(t=1),e.split("\n").map((function(e,r){return"".concat(te(""+(t+r),4," "),"  ").concat(e)})).join("\n")}function te(e,t,r){for(void 0===r&&(r="0");t>e.length;)e="".concat(r).concat(e);return e}function re(e,t){e.blendDstFactor=t.blendDstFactor,e.blendSrcFactor=t.blendSrcFactor,e.blendMode=t.blendMode}function ne(e,t){return void 0===e&&(e={}),e.compare=t.compare,e.depthFailOp=t.depthFailOp,e.passOp=t.passOp,e.failOp=t.failOp,e}function ae(e,t){return void 0===e&&(e={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),re(e.rgbBlendState,t.rgbBlendState),re(e.alphaBlendState,t.alphaBlendState),e.channelWriteMask=t.channelWriteMask,e}function oe(e,t){e.length!==t.length&&(e.length=t.length);for(var r=0;t.length>r;r++)e[r]=ae(e[r],t[r])}function ie(e,t){void 0!==t.attachmentsState&&oe(e.attachmentsState,t.attachmentsState),e.blendConstant&&t.blendConstant&&X(e.blendConstant,t.blendConstant),e.depthCompare=Z(t.depthCompare,e.depthCompare),e.depthWrite=Z(t.depthWrite,e.depthWrite),e.stencilWrite=Z(t.stencilWrite,e.stencilWrite),e.stencilFront&&t.stencilFront&&ne(e.stencilFront,t.stencilFront),e.stencilBack&&t.stencilBack&&ne(e.stencilBack,t.stencilBack),e.cullMode=Z(t.cullMode,e.cullMode),e.frontFace=Z(t.frontFace,e.frontFace),e.polygonOffset=Z(t.polygonOffset,e.polygonOffset)}function se(e){var t=Object.assign({},e);return t.attachmentsState=[],oe(t.attachmentsState,e.attachmentsState),t.blendConstant=t.blendConstant&&w(t.blendConstant),t.stencilFront=ne(void 0,e.stencilFront),t.stencilBack=ne(void 0,e.stencilBack),t}function _e(e,t){void 0!==t.channelWriteMask&&(e.channelWriteMask=t.channelWriteMask),void 0!==t.rgbBlendMode&&(e.rgbBlendState.blendMode=t.rgbBlendMode),void 0!==t.alphaBlendMode&&(e.alphaBlendState.blendMode=t.alphaBlendMode),void 0!==t.rgbBlendSrcFactor&&(e.rgbBlendState.blendSrcFactor=t.rgbBlendSrcFactor),void 0!==t.alphaBlendSrcFactor&&(e.alphaBlendState.blendSrcFactor=t.alphaBlendSrcFactor),void 0!==t.rgbBlendDstFactor&&(e.rgbBlendState.blendDstFactor=t.rgbBlendDstFactor),void 0!==t.alphaBlendDstFactor&&(e.alphaBlendState.blendDstFactor=t.alphaBlendDstFactor)}var le={blendMode:e.BlendMode.ADD,blendSrcFactor:e.BlendFactor.ONE,blendDstFactor:e.BlendFactor.ZERO},Ee={attachmentsState:[{channelWriteMask:e.ChannelWriteMask.ALL,rgbBlendState:le,alphaBlendState:le}],blendConstant:w(H),depthWrite:!0,depthCompare:e.CompareFunction.LEQUAL,stencilWrite:!1,stencilFront:{compare:e.CompareFunction.ALWAYS,passOp:e.StencilOp.KEEP,depthFailOp:e.StencilOp.KEEP,failOp:e.StencilOp.KEEP},stencilBack:{compare:e.CompareFunction.ALWAYS,passOp:e.StencilOp.KEEP,depthFailOp:e.StencilOp.KEEP,failOp:e.StencilOp.KEEP},cullMode:e.CullMode.NONE,frontFace:e.FrontFace.CCW,polygonOffset:!1};function ue(e,t){void 0===e&&(e=null),void 0===t&&(t=Ee);var r=se(t);return null!==e&&ie(r,e),r}var ce=ue({depthCompare:e.CompareFunction.ALWAYS,depthWrite:!1},Ee);var Re={texture:null,sampler:null,formatKind:e.SamplerFormatKind.Float,dimension:e.TextureDimension.TEXTURE_2D},Te=function(e,t){return Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Te(e,t)};function pe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+t+" is not a constructor or null");function r(){this.constructor=e}Te(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Ae=function(){return Ae=Object.assign||function(e){for(var t,r=1,n=arguments.length;n>r;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Ae.apply(this,arguments)};function Fe(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{_(n.next(e))}catch(e){o(e)}}function s(e){try{_(n.throw(e))}catch(e){o(e)}}function _(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}_((n=n.apply(e,t||[])).next())}))}function de(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(_){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&a[3]>s[1])){i.label=s[1];break}if(6===s[0]&&a[1]>i.label){i.label=a[1],a=s;break}if(a&&a[2]>i.label){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,_])}}}function fe(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function me(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return i}function he(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;o>a;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}var Se,ge=function(e){return null==e},Ne={}.toString,Be=function(e,t){return Ne.call(e)==="[object "+t+"]"},Ce=function(e,t,r){return t>e?t:e>r?r:e},Le=function(e){return Be(e,"Number")};function Me(e,t,r){if(e.length!==t.length)return!1;for(var n=0;e.length>n;n++)if(!r(e[n],t[n]))return!1;return!0}function Oe(e,t){for(var r=Array(e.length),n=0;e.length>n;n++)r[n]=t(e[n]);return r}function Ie(e,t){return e.buffer===t.buffer&&e.size===t.size&&e.binding===t.binding&&e.offset===t.offset}function Ue(e,t){return null===e?null===t:null!==t&&(e.sampler===t.sampler&&e.texture===t.texture&&e.dimension===t.dimension&&e.formatKind===t.formatKind&&e.comparison===t.comparison)}function De(e,t){return e.blendMode==t.blendMode&&e.blendSrcFactor===t.blendSrcFactor&&e.blendDstFactor===t.blendDstFactor}function Ge(e,t){return!!De(e.rgbBlendState,t.rgbBlendState)&&(!!De(e.alphaBlendState,t.alphaBlendState)&&e.channelWriteMask===t.channelWriteMask)}function Pe(e,t){return e.compare==t.compare&&e.depthFailOp===t.depthFailOp&&e.failOp===t.failOp&&e.passOp===t.passOp}function ve(e,t){return e.id===t.id}function ye(e,t){return e===t}function be(e,t){return e.offset===t.offset&&e.shaderLocation===t.shaderLocation&&e.format===t.format&&e.divisor===t.divisor}function xe(e,t){return ge(e)?ge(t):!ge(t)&&(e.arrayStride===t.arrayStride&&e.stepMode===t.stepMode&&Me(e.attributes,t.attributes,be))}function Xe(e){return{sampler:e.sampler,texture:e.texture,dimension:e.dimension,formatKind:e.formatKind,comparison:e.comparison}}function we(e){return{binding:e.binding,buffer:e.buffer,offset:e.offset,size:e.size}}function We(e){return{shaderLocation:e.shaderLocation,format:e.format,offset:e.offset,divisor:e.divisor}}function He(e){return ge(e)?e:{arrayStride:e.arrayStride,stepMode:e.stepMode,attributes:Oe(e.attributes,We)}}var Ve=/([^[]*)(\[[0-9]+\])?/;function ke(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};var t=e.match(Ve);if(!t||2>t.length)throw Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:Number(t[2])||1,isArray:!!t[2]}}function Ye(){var e=null;return function(t,r,n){var a=e!==n;return a&&(t.uniform1i(r,n),e=n),a}}function Ke(e,t,r,n){var a=null,o=null;return function(i,s,_){var l=t(_,r),E=l.length,u=!1;if(null===a)a=new Float32Array(E),o=E,u=!0;else{y(o===E,"Uniform length cannot change.");for(var c=0;E>c;++c)if(l[c]!==a[c]){u=!0;break}}return u&&(n(i,e,s,l),a.set(l)),u}}function qe(e,t,r,n){e[t](r,n)}function ze(e,t,r,n){e[t](r,!1,n)}var Ze={},Qe={},je={},$e=[0];function Je(e,t,r,n){1===t&&"boolean"==typeof e&&(e=e?1:0),Number.isFinite(e)&&($e[0]=e,e=$e);var a=e.length;if(e instanceof r)return e;var o=n[a];o||(o=new r(a),n[a]=o);for(var i=0;a>i;i++)o[i]=e[i];return o}function et(e,t){return Je(e,t,Float32Array,Ze)}function tt(e,t){return Je(e,t,Int32Array,Qe)}function rt(e,t){return Je(e,t,Uint32Array,je)}var nt=((Se={})[e.GL.FLOAT]=Ke.bind(null,"uniform1fv",et,1,qe),Se[e.GL.FLOAT_VEC2]=Ke.bind(null,"uniform2fv",et,2,qe),Se[e.GL.FLOAT_VEC3]=Ke.bind(null,"uniform3fv",et,3,qe),Se[e.GL.FLOAT_VEC4]=Ke.bind(null,"uniform4fv",et,4,qe),Se[e.GL.INT]=Ke.bind(null,"uniform1iv",tt,1,qe),Se[e.GL.INT_VEC2]=Ke.bind(null,"uniform2iv",tt,2,qe),Se[e.GL.INT_VEC3]=Ke.bind(null,"uniform3iv",tt,3,qe),Se[e.GL.INT_VEC4]=Ke.bind(null,"uniform4iv",tt,4,qe),Se[e.GL.BOOL]=Ke.bind(null,"uniform1iv",tt,1,qe),Se[e.GL.BOOL_VEC2]=Ke.bind(null,"uniform2iv",tt,2,qe),Se[e.GL.BOOL_VEC3]=Ke.bind(null,"uniform3iv",tt,3,qe),Se[e.GL.BOOL_VEC4]=Ke.bind(null,"uniform4iv",tt,4,qe),Se[e.GL.FLOAT_MAT2]=Ke.bind(null,"uniformMatrix2fv",et,4,ze),Se[e.GL.FLOAT_MAT3]=Ke.bind(null,"uniformMatrix3fv",et,9,ze),Se[e.GL.FLOAT_MAT4]=Ke.bind(null,"uniformMatrix4fv",et,16,ze),Se[e.GL.UNSIGNED_INT]=Ke.bind(null,"uniform1uiv",rt,1,qe),Se[e.GL.UNSIGNED_INT_VEC2]=Ke.bind(null,"uniform2uiv",rt,2,qe),Se[e.GL.UNSIGNED_INT_VEC3]=Ke.bind(null,"uniform3uiv",rt,3,qe),Se[e.GL.UNSIGNED_INT_VEC4]=Ke.bind(null,"uniform4uiv",rt,4,qe),Se[e.GL.FLOAT_MAT2x3]=Ke.bind(null,"uniformMatrix2x3fv",et,6,ze),Se[e.GL.FLOAT_MAT2x4]=Ke.bind(null,"uniformMatrix2x4fv",et,8,ze),Se[e.GL.FLOAT_MAT3x2]=Ke.bind(null,"uniformMatrix3x2fv",et,6,ze),Se[e.GL.FLOAT_MAT3x4]=Ke.bind(null,"uniformMatrix3x4fv",et,12,ze),Se[e.GL.FLOAT_MAT4x2]=Ke.bind(null,"uniformMatrix4x2fv",et,8,ze),Se[e.GL.FLOAT_MAT4x3]=Ke.bind(null,"uniformMatrix4x3fv",et,12,ze),Se[e.GL.SAMPLER_2D]=Ye,Se[e.GL.SAMPLER_CUBE]=Ye,Se[e.GL.SAMPLER_3D]=Ye,Se[e.GL.SAMPLER_2D_SHADOW]=Ye,Se[e.GL.SAMPLER_2D_ARRAY]=Ye,Se[e.GL.SAMPLER_2D_ARRAY_SHADOW]=Ye,Se[e.GL.SAMPLER_CUBE_SHADOW]=Ye,Se[e.GL.INT_SAMPLER_2D]=Ye,Se[e.GL.INT_SAMPLER_3D]=Ye,Se[e.GL.INT_SAMPLER_CUBE]=Ye,Se[e.GL.INT_SAMPLER_2D_ARRAY]=Ye,Se[e.GL.UNSIGNED_INT_SAMPLER_2D]=Ye,Se[e.GL.UNSIGNED_INT_SAMPLER_3D]=Ye,Se[e.GL.UNSIGNED_INT_SAMPLER_CUBE]=Ye,Se[e.GL.UNSIGNED_INT_SAMPLER_2D_ARRAY]=Ye,Se);function at(e,t,r){var n=nt[r.type];if(!n)throw Error("Unknown GLSL uniform type ".concat(r.type));return n().bind(null,e,t)}var ot={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function it(e){return Object.prototype.toString.call(e)in ot}function st(e,t){return"#define ".concat(e," ").concat(t)}function _t(e){var t={};return e.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,(function(e,r,n){var a=Number(n);return t[r]=isNaN(a)?n:a,""})),t}function lt(e,t){var r=[];return e.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,(function(e,n,a){var o=Number(n);return r.push({location:isNaN(o)?t[n]:o,name:a}),""})),r}function Et(e){if(void 0===e)return null;var t=/binding\s*=\s*(\d+)/.exec(e);if(null!==t){var r=parseInt(t[1],10);if(!Number.isNaN(r))return r}return null}function ut(t,r,n,a,o){var i;void 0===a&&(a=null),void 0===o&&(o=!0);var s="#version 100"===t.glslVersion,_="frag"===r&&(null===(i=n.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))||void 0===i?void 0:i.length)>1,l=n.replace("\r\n","\n").split("\n").map((function(e){return e.replace(/[/][/].*$/,"")})).filter((function(e){return!(!e||/^\s+$/.test(e))})),E="";null!==a&&(E=Object.keys(a).map((function(e){return st(e,a[e])})).join("\n"));var u=l.find((function(e){return e.startsWith("precision")}))||"precision mediump float;",c=o?l.filter((function(e){return!e.startsWith("precision")})).join("\n"):l.join("\n"),R="";if(t.viewportOrigin===e.ViewportOrigin.UPPER_LEFT&&(R+="".concat(st("VIEWPORT_ORIGIN_TL","1"),"\n")),t.clipSpaceNearZ===e.ClipSpaceNearZ.ZERO&&(R+="".concat(st("CLIPSPACE_NEAR_ZERO","1"),"\n")),t.explicitBindingLocations){var T=0,p=0,A=0;c=c.replace(/^(layout\((.*)\))?\s*uniform(.+{)$/gm,(function(e,t,r,n){return"layout(".concat(r?"".concat(r,", "):"","set = ").concat(T,", binding = ").concat(p++,") uniform ").concat(n)})),T++,p=0,y(t.separateSamplerTextures),c=c.replace(/^(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,(function(e,t,n,a,o){var i=Et(n);null===i&&(i=p++);var s=me(function(e){return[e,""]}(a),2),_=s[0],l=s[1];return"frag"===r?"\nlayout(set = ".concat(T,", binding = ").concat(2*i+0,") uniform texture").concat(_," T_").concat(o,";\nlayout(set = ").concat(T,", binding = ").concat(2*i+1,") uniform sampler").concat(l," S_").concat(o,";").trim():""})),c=c.replace("frag"===r?/^\s*\b(varying|in)\b/gm:/^\s*\b(varying|out)\b/gm,(function(e,t){return"layout(location = ".concat(A++,") ").concat(t)})),R+="".concat(st("gl_VertexID","gl_VertexIndex"),"\n"),R+="".concat(st("gl_InstanceID","gl_InstanceIndex"),"\n"),u=u.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var F=0;c=c.replace(/^(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,(function(e,t,r,n,a){var o=Et(r);return null===o&&(o=F++),"uniform sampler".concat(n," ").concat(a,"; // BINDING=").concat(o)}))}if(t.separateSamplerTextures)c=(c=c.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,(function(e,t,r){return"sampler".concat(t,"(T_").concat(r,", S_").concat(r,")")}))).replace(/\bTEXTURE\((.*?)\)/g,(function(e,t){return"T_".concat(t)}));else{var d=[];c=c.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,(function(e,t,r){return d.push([r,t]),r})),s&&d.forEach((function(e){var t=me(e,2),r=t[0],n=t[1];c=c.replace(RegExp("texture\\(".concat(r),"g"),(function(){return"texture".concat(n,"(").concat(r)}))})),c=c.replace(/\bTEXTURE\((.*?)\)/g,(function(e,t){return t}))}var f="".concat(s?"":t.glslVersion,"\n").concat(s&&_?"#extension GL_EXT_draw_buffers : require\n":"","\n").concat(s&&"frag"===r?"#extension GL_OES_standard_derivatives : enable\n":"").concat(o?u:"","\n").concat(R||"").concat(E?E+"\n":"","\n").concat(c,"\n").trim();if(t.explicitBindingLocations&&"frag"===r&&(f=f.replace(/^\b(out)\b/g,(function(e,t){return"layout(location = 0) ".concat(t)}))),s){if("frag"===r&&(f=f.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,(function(e,t,r){return"varying ".concat(t," ").concat(r,";\n")}))),"vert"===r&&(f=(f=f.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,(function(e,t,r){return"varying ".concat(t," ").concat(r,";\n")}))).replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,(function(e,t,r){return"attribute ".concat(t," ").concat(r,";\n")}))),f=f.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,(function(e,t){return t.trim().replace(/^.*$/gm,(function(e){var t=e.trim();return t.startsWith("#")?t:e?"uniform ".concat(t):""}))})),"frag"===r)if(_){var m=[],h=(f=f.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,(function(e,t){return m.push(t),"vec4 ".concat(t,";\n")}))).lastIndexOf("}");f=f.substring(0,h)+"\n    ".concat(m.map((function(e,t){return"gl_FragData[".concat(t,"] = ").concat(e,";\n    ")})).join("\n"))+f.substring(h)}else{var S;if(f=f.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,(function(e,t,r){return S=r,"".concat(t," ").concat(r,";\n")})),S){h=f.lastIndexOf("}");f=f.substring(0,h)+"\n  gl_FragColor = vec4(".concat(S,");\n")+f.substring(h)}}f=f.replace(/^\s*layout\((.*)\)/gm,"")}return f}function ct(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rt={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,o||e,i),_=r?r+t:t;return e._events[_]?e._events[_].fn?e._events[_]=[e._events[_],s]:e._events[_].push(s):(e._events[_]=s,e._eventsCount++),e}function i(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,a=[];if(0===this._eventsCount)return a;for(n in e=this._events)t.call(e,n)&&a.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=this._events[r?r+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,a=t.length,o=Array(a);a>n;n++)o[n]=t[n].fn;return o},s.prototype.listenerCount=function(e){var t=this._events[r?r+e:e];return t?t.fn?1:t.length:0},s.prototype.emit=function(e,t,n,a,o,i){var s=r?r+e:e;if(!this._events[s])return!1;var _,l,E=this._events[s],u=arguments.length;if(E.fn){switch(E.once&&this.removeListener(e,E.fn,void 0,!0),u){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,t),!0;case 3:return E.fn.call(E.context,t,n),!0;case 4:return E.fn.call(E.context,t,n,a),!0;case 5:return E.fn.call(E.context,t,n,a,o),!0;case 6:return E.fn.call(E.context,t,n,a,o,i),!0}for(l=1,_=Array(u-1);u>l;l++)_[l-1]=arguments[l];E.fn.apply(E.context,_)}else{var c,R=E.length;for(l=0;R>l;l++)switch(E[l].once&&this.removeListener(e,E[l].fn,void 0,!0),u){case 1:E[l].fn.call(E[l].context);break;case 2:E[l].fn.call(E[l].context,t);break;case 3:E[l].fn.call(E[l].context,t,n);break;case 4:E[l].fn.call(E[l].context,t,n,a);break;default:if(!_)for(c=1,_=Array(u-1);u>c;c++)_[c-1]=arguments[c];E[l].fn.apply(E[l].context,_)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,a){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return i(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||a&&!s.once||n&&s.context!==n||i(this,o);else{for(var _=0,l=[],E=s.length;E>_;_++)(s[_].fn!==t||a&&!s[_].once||n&&s[_].context!==n)&&l.push(s[_]);l.length?this._events[o]=1===l.length?l[0]:l:i(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?this._events[t=r?r+e:e]&&i(this,t):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(Rt);var Tt=ct(Rt.exports),pt=function(e){function t(t){var r=t.id,n=t.device,a=e.call(this)||this;return a.id=r,a.device=n,null!==a.device.resourceCreationTracker&&a.device.resourceCreationTracker.trackResourceCreated(a),a}return pe(t,e),t.prototype.destroy=function(){null!==this.device.resourceCreationTracker&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},t}(Tt),At=function(t){function r(r){var n=r.descriptor,a=t.call(this,{id:r.id,device:r.device})||this;a.type=e.ResourceType.Bindings;var o=n.samplerBindings;return a.uniformBufferBindings=n.uniformBufferBindings||[],a.samplerBindings=o||[],a.bindingLayouts=a.createBindingLayouts(),a}return pe(r,t),r.prototype.createBindingLayouts=function(){var e=0,t=0,r=[],n=this.uniformBufferBindings.length,a=this.samplerBindings.length;return r.push({firstUniformBuffer:e,numUniformBuffers:n,firstSampler:t,numSamplers:a}),{numUniformBuffers:e+=n,numSamplers:t+=a,bindingLayoutTables:r}},r}(pt);function Ft(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||!(!e||2!==e._version)}function dt(t){switch(I(t)){case e.FormatTypeFlags.BC1:case e.FormatTypeFlags.BC2:case e.FormatTypeFlags.BC3:case e.FormatTypeFlags.BC4_UNORM:case e.FormatTypeFlags.BC4_SNORM:case e.FormatTypeFlags.BC5_UNORM:case e.FormatTypeFlags.BC5_SNORM:return!0;default:return!1}}function ft(t){if(U(t)&e.FormatFlags.Normalized)return!1;var r=I(t);return r===e.FormatTypeFlags.S8||r===e.FormatTypeFlags.S16||r===e.FormatTypeFlags.S32||(r===e.FormatTypeFlags.U8||r===e.FormatTypeFlags.U16||r===e.FormatTypeFlags.U32)}function mt(t){return t&e.BufferUsage.INDEX?e.GL.ELEMENT_ARRAY_BUFFER:t&e.BufferUsage.VERTEX?e.GL.ARRAY_BUFFER:t&e.BufferUsage.UNIFORM?e.GL.UNIFORM_BUFFER:void 0}function ht(t){var r=I(t),n=O(t),a=U(t),o=function(t){switch(t){case e.FormatTypeFlags.U8:return e.GL.UNSIGNED_BYTE;case e.FormatTypeFlags.U16:return e.GL.UNSIGNED_SHORT;case e.FormatTypeFlags.U32:return e.GL.UNSIGNED_INT;case e.FormatTypeFlags.S8:return e.GL.BYTE;case e.FormatTypeFlags.S16:return e.GL.SHORT;case e.FormatTypeFlags.S32:return e.GL.INT;case e.FormatTypeFlags.F16:return e.GL.HALF_FLOAT;case e.FormatTypeFlags.F32:return e.GL.FLOAT;default:throw Error("whoops")}}(r),i=function(t){switch(t){case e.FormatCompFlags.R:return 1;case e.FormatCompFlags.RG:return 2;case e.FormatCompFlags.RGB:return 3;case e.FormatCompFlags.RGBA:return 4;default:return 1}}(n);return{size:i,type:o,normalized:!!(a&e.FormatFlags.Normalized)}}function St(t){switch(t){case e.AddressMode.CLAMP_TO_EDGE:return e.GL.CLAMP_TO_EDGE;case e.AddressMode.REPEAT:return e.GL.REPEAT;case e.AddressMode.MIRRORED_REPEAT:return e.GL.MIRRORED_REPEAT;default:throw Error("whoops")}}function gt(t,r){if(r===e.MipmapFilterMode.LINEAR&&t===e.FilterMode.BILINEAR)return e.GL.LINEAR_MIPMAP_LINEAR;if(r===e.MipmapFilterMode.LINEAR&&t===e.FilterMode.POINT)return e.GL.NEAREST_MIPMAP_LINEAR;if(r===e.MipmapFilterMode.NEAREST&&t===e.FilterMode.BILINEAR)return e.GL.LINEAR_MIPMAP_NEAREST;if(r===e.MipmapFilterMode.NEAREST&&t===e.FilterMode.POINT)return e.GL.NEAREST_MIPMAP_NEAREST;if(r===e.MipmapFilterMode.NO_MIP&&t===e.FilterMode.BILINEAR)return e.GL.LINEAR;if(r===e.MipmapFilterMode.NO_MIP&&t===e.FilterMode.POINT)return e.GL.NEAREST;throw Error("Unknown texture filter mode")}function Nt(e,t){void 0===t&&(t=0);return e.gl_buffer_pages[t/e.pageByteSize|0]}function Bt(e){return e.gl_texture}function Ct(e){return e.gl_sampler}function Lt(e,t){e.name=t,e.__SPECTOR_Metadata={name:t}}function Mt(e,t){for(var r=[];;){var n=t.exec(e);if(!n)break;r.push(n)}return r}function Ot(t){return t.blendMode==e.BlendMode.ADD&&t.blendSrcFactor==e.BlendFactor.ONE&&t.blendDstFactor===e.BlendFactor.ZERO}function It(t){if(t===e.TextureDimension.TEXTURE_2D)return e.GL.TEXTURE_2D;if(t===e.TextureDimension.TEXTURE_2D_ARRAY)return e.GL.TEXTURE_2D_ARRAY;if(t===e.TextureDimension.TEXTURE_CUBE_MAP)return e.GL.TEXTURE_CUBE_MAP;if(t===e.TextureDimension.TEXTURE_3D)return e.GL.TEXTURE_3D;throw Error("whoops")}function Ut(e,t,r,n){return e%r==0&&t%n==0}var Dt,Gt=function(t){function r(r){var n=r.device,a=r.descriptor,o=t.call(this,{id:r.id,device:n})||this;o.type=e.ResourceType.Buffer;var i=a.viewOrSize,s=a.usage,_=a.hint,l=void 0===_?e.BufferFrequencyHint.STATIC:_,E=n.uniformBufferMaxPageByteSize,u=n.gl,c=s&e.BufferUsage.UNIFORM;c||(Ft(u)?u.bindVertexArray(null):n.OES_vertex_array_object.bindVertexArrayOES(null));var R,T=Le(i)?j(i,4):j(i.byteLength,4);if(o.gl_buffer_pages=[],c){for(var p=T;p>0;)o.gl_buffer_pages.push(o.createBufferPage(Math.min(p,E),s,l)),p-=E;R=E}else o.gl_buffer_pages.push(o.createBufferPage(T,s,l)),R=T;return o.pageByteSize=R,o.byteSize=T,o.usage=s,o.gl_target=mt(s),Le(i)||o.setSubData(0,new Uint8Array(i.buffer)),c||(Ft(u)?u.bindVertexArray(o.device.currentBoundVAO):n.OES_vertex_array_object.bindVertexArrayOES(o.device.currentBoundVAO)),o}return pe(r,t),r.prototype.setSubData=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=t.byteLength-r);for(var a=this.device.gl,o=this.pageByteSize,i=e+n,s=e,_=e%o;i>s;){var l=Ft(a)?a.COPY_WRITE_BUFFER:this.gl_target,E=Nt(this,s);if(E.ubo)return;a.bindBuffer(l,E),Ft(a)?a.bufferSubData(l,_,t,r,Math.min(i-s,o)):a.bufferSubData(l,_,t),s+=o,_=0,r+=o,this.device.debugGroupStatisticsBufferUpload()}},r.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;this.gl_buffer_pages.length>e;e++)this.gl_buffer_pages[e].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[e]);this.gl_buffer_pages=[]},r.prototype.createBufferPage=function(t,r,n){var a=this.device.gl,o=r&e.BufferUsage.UNIFORM;if(!Ft(a)&&o)return{ubo:!0};var i=this.device.ensureResourceExists(a.createBuffer()),s=mt(r),_=function(t){switch(t){case e.BufferFrequencyHint.STATIC:return e.GL.STATIC_DRAW;case e.BufferFrequencyHint.DYNAMIC:return e.GL.DYNAMIC_DRAW}}(n);return a.bindBuffer(s,i),a.bufferData(s,t,_),i},r}(pt),Pt=function(t){function r(r){var n,a,o,i,s,_=r.device,l=r.descriptor,E=t.call(this,{id:r.id,device:_})||this;E.type=e.ResourceType.InputLayout;var u=l.vertexBufferDescriptors,c=l.indexBufferFormat,R=l.program;y(c===e.Format.U16_R||c===e.Format.U32_R||null===c);var T=null!==c?function(t){switch(t){case e.Format.U8_R:return e.GL.UNSIGNED_BYTE;case e.Format.U16_R:return e.GL.UNSIGNED_SHORT;case e.Format.U32_R:return e.GL.UNSIGNED_INT;default:throw Error("whoops")}}(c):null,p=null!==c?G(c):null,A=E.device.gl,F=E.device.ensureResourceExists(Ft(A)?A.createVertexArray():_.OES_vertex_array_object.createVertexArrayOES());Ft(A)?A.bindVertexArray(F):_.OES_vertex_array_object.bindVertexArrayOES(F),A.bindBuffer(A.ARRAY_BUFFER,Nt(E.device.fallbackVertexBuffer));try{for(var d=fe(l.vertexBufferDescriptors),f=d.next();!f.done;f=d.next()){var m=f.value,h=m.stepMode,S=m.attributes;try{for(var g=(o=void 0,fe(S)),N=g.next();!N.done;N=g.next()){var B=N.value,C=B.shaderLocation,L=B.format,M=B.divisor,O=void 0===M?1:M,I=Ft(A)?C:null===(s=R.attributes[C])||void 0===s?void 0:s.location,U=ht(L);if(B.vertexFormat=U,!ge(I))ft(L),A.vertexAttribPointer(I,U.size,U.type,U.normalized,0,0),h===e.VertexStepMode.INSTANCE&&(Ft(A)?A.vertexAttribDivisor(I,O):_.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(I,O)),A.enableVertexAttribArray(I)}}catch(e){o={error:e}}finally{try{N&&!N.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}return Ft(A)?A.bindVertexArray(null):_.OES_vertex_array_object.bindVertexArrayOES(null),E.vertexBufferDescriptors=u,E.vao=F,E.indexBufferFormat=c,E.indexBufferType=T,E.indexBufferCompByteSize=p,E.program=R,E}return pe(r,t),r.prototype.destroy=function(){t.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(Ft(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},r}(pt),vt=function(t){function r(r){var n=r.device,a=r.descriptor,o=r.fake,i=t.call(this,{id:r.id,device:n})||this;i.type=e.ResourceType.Texture,a=Ae({dimension:e.TextureDimension.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},a);var s,_,l=i.device.gl,E=i.clampmipLevelCount(a);if(i.immutable=a.usage===e.TextureUsage.RENDER_TARGET,i.pixelStore=a.pixelStore,i.format=a.format,i.dimension=a.dimension,i.formatKind=v(a.format),i.width=a.width,i.height=a.height,i.depthOrArrayLayers=a.depthOrArrayLayers,i.mipmaps=E>=1,!o){_=i.device.ensureResourceExists(l.createTexture());var u=i.device.translateTextureType(a.format),c=i.device.translateTextureInternalFormat(a.format);if(i.device.setActiveTexture(l.TEXTURE0),i.device.currentTextures[0]=null,i.preprocessImage(),a.dimension===e.TextureDimension.TEXTURE_2D){if(l.bindTexture(s=e.GL.TEXTURE_2D,_),i.immutable)if(Ft(l))l.texStorage2D(s,E,c,a.width,a.height);else{var R=(c===e.GL.DEPTH_COMPONENT||i.isNPOT(),0);(i.format!==e.Format.D32F&&i.format!==e.Format.D24_S8||Ft(l)||n.WEBGL_depth_texture)&&(l.texImage2D(s,R,c,a.width,a.height,0,c,u,null),i.mipmaps&&(i.mipmaps=!1,l.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,e.GL.LINEAR),l.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_S,e.GL.CLAMP_TO_EDGE),l.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_T,e.GL.CLAMP_TO_EDGE)))}y(1===a.depthOrArrayLayers)}else if(a.dimension===e.TextureDimension.TEXTURE_2D_ARRAY)l.bindTexture(s=e.GL.TEXTURE_2D_ARRAY,_),i.immutable&&Ft(l)&&l.texStorage3D(s,E,c,a.width,a.height,a.depthOrArrayLayers);else if(a.dimension===e.TextureDimension.TEXTURE_3D)l.bindTexture(s=e.GL.TEXTURE_3D,_),i.immutable&&Ft(l)&&l.texStorage3D(s,E,c,a.width,a.height,a.depthOrArrayLayers);else{if(a.dimension!==e.TextureDimension.TEXTURE_CUBE_MAP)throw Error("whoops");l.bindTexture(s=e.GL.TEXTURE_CUBE_MAP,_),i.immutable&&Ft(l)&&l.texStorage2D(s,E,c,a.width,a.height),y(6===a.depthOrArrayLayers)}}return i.gl_texture=_,i.gl_target=s,i.mipLevelCount=E,i}return pe(r,t),r.prototype.setImageData=function(t,r){void 0===r&&(r=0);var n=this.device.gl;dt(this.format);var a=this.gl_target===e.GL.TEXTURE_3D||this.gl_target===e.GL.TEXTURE_2D_ARRAY,o=this.gl_target===e.GL.TEXTURE_CUBE_MAP,i=it(t[0]);this.device.setActiveTexture(n.TEXTURE0),this.device.currentTextures[0]=null;var s,_,l=t[0];i?(s=this.width,_=this.height):(_=l.height,this.width=s=l.width,this.height=_),n.bindTexture(this.gl_target,this.gl_texture);var E=this.device.translateTextureFormat(this.format),u=Ft(n)?this.device.translateInternalTextureFormat(this.format):E,c=this.device.translateTextureType(this.format);this.preprocessImage();for(var R=0;this.depthOrArrayLayers>R;R++){var T=t[R],p=this.gl_target;o&&(p=e.GL.TEXTURE_CUBE_MAP_POSITIVE_X+R%6),this.immutable?n.texSubImage2D(p,r,0,0,s,_,E,c,T):Ft(n)?a?n.texImage3D(p,r,u,s,_,this.depthOrArrayLayers,0,E,c,T):n.texImage2D(p,r,u,s,_,0,E,c,T):i?n.texImage2D(p,r,E,s,_,0,E,c,T):n.texImage2D(p,r,E,E,c,T)}this.mipmaps&&this.generateMipmap(a)},r.prototype.destroy=function(){t.prototype.destroy.call(this),this.device.gl.deleteTexture(Bt(this))},r.prototype.clampmipLevelCount=function(t){if(t.dimension===e.TextureDimension.TEXTURE_2D_ARRAY&&t.depthOrArrayLayers>1&&I(t.format)===e.FormatTypeFlags.BC1)for(var r=t.width,n=t.height,a=0;t.mipLevelCount>a;a++){if(2>=r||2>=n)return a-1;r=Math.max(r/2|0,1),n=Math.max(n/2|0,1)}return t.mipLevelCount},r.prototype.preprocessImage=function(){var t=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&t.pixelStorei(e.GL.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&t.pixelStorei(e.GL.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&t.pixelStorei(e.GL.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},r.prototype.generateMipmap=function(t){void 0===t&&(t=!1);var r=this.device.gl;return!Ft(r)&&this.isNPOT()||this.gl_texture&&this.gl_target&&(r.bindTexture(this.gl_target,this.gl_texture),t?(r.texParameteri(this.gl_target,e.GL.TEXTURE_BASE_LEVEL,0),r.texParameteri(this.gl_target,e.GL.TEXTURE_MAX_LEVEL,Math.log2(this.width)),r.texParameteri(this.gl_target,e.GL.TEXTURE_MIN_FILTER,e.GL.LINEAR_MIPMAP_LINEAR),r.texParameteri(this.gl_target,e.GL.TEXTURE_MAG_FILTER,e.GL.LINEAR)):r.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,e.GL.NEAREST_MIPMAP_LINEAR),r.generateMipmap(this.gl_target),r.bindTexture(this.gl_target,null)),this},r.prototype.isNPOT=function(){return!Ft(this.device.gl)&&(!z(this.width)||!z(this.height))},r}(pt),yt=function(t){function r(r){var n=r.device,a=r.descriptor,o=t.call(this,{id:r.id,device:n})||this;o.type=e.ResourceType.RenderTarget,o.gl_renderbuffer=null,o.texture=null;var i=o.device.gl,s=a.format,_=a.width,l=a.height,E=a.sampleCount,u=void 0===E?1:E,c=a.texture,R=!1;if(s!==e.Format.D32F&&s!==e.Format.D24_S8||!c||Ft(i)||n.WEBGL_depth_texture||(c.destroy(),o.texture=null,R=!0),!R&&c)o.texture=c;else{o.gl_renderbuffer=o.device.ensureResourceExists(i.createRenderbuffer()),i.bindRenderbuffer(i.RENDERBUFFER,o.gl_renderbuffer);var T=o.device.translateTextureInternalFormat(s,!0);Ft(i)&&u>1?i.renderbufferStorageMultisample(e.GL.RENDERBUFFER,u,T,_,l):i.renderbufferStorage(e.GL.RENDERBUFFER,T,_,l)}return o.format=s,o.width=_,o.height=l,o.sampleCount=u,o}return pe(r,t),r.prototype.destroy=function(){t.prototype.destroy.call(this),null!==this.gl_renderbuffer&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},r}(pt);!function(e){e[e.NeedsCompile=0]="NeedsCompile",e[e.Compiling=1]="Compiling",e[e.NeedsBind=2]="NeedsBind",e[e.ReadyToUse=3]="ReadyToUse"}(Dt||(Dt={}));var bt=function(t){function r(r,n){var a=r.descriptor,o=t.call(this,{id:r.id,device:r.device})||this;o.rawVertexGLSL=n,o.type=e.ResourceType.Program,o.uniformSetters={},o.attributes=[];var i=o.device.gl;return o.descriptor=a,o.gl_program=o.device.ensureResourceExists(i.createProgram()),o.gl_shader_vert=null,o.gl_shader_frag=null,o.compileState=Dt.NeedsCompile,o.tryCompileProgram(),o}return pe(r,t),r.prototype.destroy=function(){t.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},r.prototype.tryCompileProgram=function(){var e,t;y(this.compileState===Dt.NeedsCompile);var r=this.descriptor,n=this.device.gl;(null===(e=r.vertex)||void 0===e?void 0:e.glsl)&&(null===(t=r.fragment)||void 0===t?void 0:t.glsl)&&(this.gl_shader_vert=this.compileShader(r.vertex.glsl,n.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(r.fragment.glsl,n.FRAGMENT_SHADER),n.attachShader(this.gl_program,this.gl_shader_vert),n.attachShader(this.gl_program,this.gl_shader_frag),n.linkProgram(this.gl_program),this.compileState=Dt.Compiling,Ft(n)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},r.prototype.readAttributesFromLinkedProgram=function(){for(var e,t=this.device.gl,r=t.getProgramParameter(this.gl_program,t.ACTIVE_ATTRIBUTES),n=_t(this.descriptor.vertex.glsl),a=lt(this.rawVertexGLSL,n),o=function(r){var n=t.getActiveAttrib(i.gl_program,r),o=n.name,s=n.type,_=n.size,l=t.getAttribLocation(i.gl_program,o),E=null===(e=a.find((function(e){return e.name===o})))||void 0===e?void 0:e.location;0>l||ge(E)||(i.attributes[E]={name:o,location:l,type:s,size:_})},i=this,s=0;r>s;s++)o(s)},r.prototype.readUniformLocationsFromLinkedProgram=function(){for(var e=this.device.gl,t=e.getProgramParameter(this.gl_program,e.ACTIVE_UNIFORMS),r=0;t>r;r++){var n=e.getActiveUniform(this.gl_program,r),a=ke(n.name).name,o=e.getUniformLocation(this.gl_program,a);if(this.uniformSetters[a]=at(e,o,n),n&&n.size>1)for(var i=0;n.size>i;i++)o=e.getUniformLocation(this.gl_program,"".concat(a,"[").concat(i,"]")),this.uniformSetters["".concat(a,"[").concat(i,"]")]=at(e,o,n)}},r.prototype.compileShader=function(e,t){var r=this.device.gl,n=this.device.ensureResourceExists(r.createShader(t));return r.shaderSource(n,e),r.compileShader(n),n},r.prototype.setUniformsLegacy=function(e){void 0===e&&(e={});var t=this.device.gl;if(!Ft(t)){var r=!1;for(var n in e){r||(t.useProgram(this.gl_program),r=!0);var a=this.uniformSetters[n];if(a){var o=e[n];o instanceof vt&&(o=o.textureIndex),a(o)}}}return this},r}(pt),xt=function(t){function r(r){var n=r.descriptor,a=t.call(this,{id:r.id,device:r.device})||this;a.type=e.ResourceType.QueryPool;var o=a.device.gl;if(Ft(o)){var i=n.type;a.gl_query=J(n.elemCount,(function(){return a.device.ensureResourceExists(o.createQuery())})),a.gl_query_type=function(t){if(t===e.QueryPoolType.OcclusionConservative)return e.GL.ANY_SAMPLES_PASSED_CONSERVATIVE;throw Error("whoops")}(i)}return a}return pe(r,t),r.prototype.queryResultOcclusion=function(e){var t=this.device.gl;if(Ft(t)){var r=this.gl_query[e];return t.getQueryParameter(r,t.QUERY_RESULT_AVAILABLE)?!!t.getQueryParameter(r,t.QUERY_RESULT):null}return null},r.prototype.destroy=function(){t.prototype.destroy.call(this);var e=this.device.gl;if(Ft(e))for(var r=0;this.gl_query.length>r;r++)e.deleteQuery(this.gl_query[r])},r}(pt),Xt=function(t){function r(r){var n=t.call(this,{id:r.id,device:r.device})||this;return n.type=e.ResourceType.Readback,n.gl_pbo=null,n.gl_sync=null,n}return pe(r,t),r.prototype.clientWaitAsync=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=10);var n=this.device.gl;return new Promise((function(a,o){!function i(){var s=n.clientWaitSync(e,t,0);s!=n.WAIT_FAILED?s!=n.TIMEOUT_EXPIRED?a():setTimeout(i,Ce(r,0,n.MAX_CLIENT_WAIT_TIMEOUT_WEBGL)):o()}()}))},r.prototype.getBufferSubDataAsync=function(e,t,r,n,a,o){return Fe(this,void 0,void 0,(function(){var i;return de(this,(function(s){switch(s.label){case 0:return Ft(i=this.device.gl)?(this.gl_sync=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0),i.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return s.sent(),i.bindBuffer(e,t),i.getBufferSubData(e,r,n,a,o),i.bindBuffer(e,null),[2,n];case 2:return[2]}}))}))},r.prototype.readTexture=function(t,r,n,a,o,i,s,_){return void 0===s&&(s=0),void 0===_&&(_=i.byteLength||0),Fe(this,void 0,void 0,(function(){var l,E,u,c,R;return de(this,(function(T){return l=this.device.gl,u=this.device.translateTextureFormat((E=t).format),c=this.device.translateTextureType(E.format),R=P(E.format),Ft(l)?(this.gl_pbo=this.device.ensureResourceExists(l.createBuffer()),l.bindBuffer(l.PIXEL_PACK_BUFFER,this.gl_pbo),l.bufferData(l.PIXEL_PACK_BUFFER,_,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),l.bindFramebuffer(e.GL.READ_FRAMEBUFFER,this.device.readbackFramebuffer),l.framebufferTexture2D(e.GL.READ_FRAMEBUFFER,e.GL.COLOR_ATTACHMENT0,e.GL.TEXTURE_2D,E.gl_texture,0),l.bindBuffer(l.PIXEL_PACK_BUFFER,this.gl_pbo),l.readPixels(r,n,a,o,u,c,s*R),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(l.PIXEL_PACK_BUFFER,this.gl_pbo,0,i,s,0)]):[2,this.readTextureSync(t,r,n,a,o,i,s,_)]}))}))},r.prototype.readTextureSync=function(t,r,n,a,o,i,s,_){void 0===_&&(_=i.byteLength||0);var l=this.device.gl,E=t,u=this.device.translateTextureType(E.format);return l.bindFramebuffer(e.GL.FRAMEBUFFER,this.device.readbackFramebuffer),l.framebufferTexture2D(e.GL.FRAMEBUFFER,e.GL.COLOR_ATTACHMENT0,e.GL.TEXTURE_2D,E.gl_texture,0),l.pixelStorei(l.PACK_ALIGNMENT,4),l.readPixels(r,n,a,o,l.RGBA,u,i),i},r.prototype.readBuffer=function(e,t,r,n,a){return Fe(this,void 0,void 0,(function(){var o;return de(this,(function(i){return Ft(o=this.device.gl)?[2,this.getBufferSubDataAsync(o.ARRAY_BUFFER,Nt(e,t),t,r,n,a)]:[2,Promise.reject()]}))}))},r.prototype.destroy=function(){t.prototype.destroy.call(this),Ft(this.device.gl)&&(null!==this.gl_sync&&this.device.gl.deleteSync(this.gl_sync),null!==this.gl_pbo&&this.device.gl.deleteBuffer(this.gl_pbo))},r}(pt),wt=function(t){function r(r){var n,a,o=r.descriptor,i=t.call(this,{id:r.id,device:r.device})||this;return i.type=e.ResourceType.RenderPipeline,i.drawMode=function(t){switch(t){case e.PrimitiveTopology.TRIANGLES:return e.GL.TRIANGLES;case e.PrimitiveTopology.POINTS:return e.GL.POINTS;case e.PrimitiveTopology.TRIANGLE_STRIP:return e.GL.TRIANGLE_STRIP;case e.PrimitiveTopology.LINES:return e.GL.LINES;case e.PrimitiveTopology.LINE_STRIP:return e.GL.LINE_STRIP;default:throw Error("Unknown primitive topology mode")}}(null!==(n=o.topology)&&void 0!==n?n:e.PrimitiveTopology.TRIANGLES),i.program=o.program,i.inputLayout=o.inputLayout,i.megaState=Ae(Ae({},se(Ee)),o.megaStateDescriptor),i.colorAttachmentFormats=o.colorAttachmentFormats.slice(),i.depthStencilAttachmentFormat=o.depthStencilAttachmentFormat,i.sampleCount=null!==(a=o.sampleCount)&&void 0!==a?a:1,i}return pe(r,t),r}(pt),Wt=function(t){function r(r){var n=r.descriptor,a=t.call(this,{id:r.id,device:r.device})||this;return a.type=e.ResourceType.ComputePipeline,a.descriptor=n,a}return pe(r,t),r}(pt),Ht=function(){function e(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return e.prototype.trackResourceCreated=function(e){this.creationStacks.set(e,Error().stack),this.liveObjects.add(e)},e.prototype.trackResourceDestroyed=function(e){this.deletionStacks.has(e)&&console.warn("Object double freed:",e,"\n\nCreation stack: ",this.creationStacks.get(e),"\n\nDeletion stack: ",this.deletionStacks.get(e),"\n\nThis stack: ",Error().stack),this.deletionStacks.set(e,Error().stack),this.liveObjects.delete(e)},e.prototype.checkForLeaks=function(){var e,t;try{for(var r=fe(this.liveObjects.values()),n=r.next();!n.done;n=r.next()){var a=n.value;console.warn("Object leaked:",a,"Creation stack:",this.creationStacks.get(a))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.setResourceLeakCheck=function(e,t){t?this.liveObjects.add(e):this.liveObjects.delete(e)},e}(),Vt=function(t){function r(r){var n,a,o=r.descriptor,i=t.call(this,{id:r.id,device:r.device})||this;i.type=e.ResourceType.Sampler;var s=i.device.gl;if(Ft(s)){var _=i.device.ensureResourceExists(s.createSampler());s.samplerParameteri(_,e.GL.TEXTURE_WRAP_S,St(o.addressModeU)),s.samplerParameteri(_,e.GL.TEXTURE_WRAP_T,St(o.addressModeV)),s.samplerParameteri(_,e.GL.TEXTURE_WRAP_R,St(null!==(n=o.addressModeW)&&void 0!==n?n:o.addressModeU)),s.samplerParameteri(_,e.GL.TEXTURE_MIN_FILTER,gt(o.minFilter,o.mipmapFilter)),s.samplerParameteri(_,e.GL.TEXTURE_MAG_FILTER,gt(o.magFilter,e.MipmapFilterMode.NO_MIP)),void 0!==o.lodMinClamp&&s.samplerParameterf(_,e.GL.TEXTURE_MIN_LOD,o.lodMinClamp),void 0!==o.lodMaxClamp&&s.samplerParameterf(_,e.GL.TEXTURE_MAX_LOD,o.lodMaxClamp),void 0!==o.compareFunction&&(s.samplerParameteri(_,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.samplerParameteri(_,s.TEXTURE_COMPARE_FUNC,o.compareFunction));var l=null!==(a=o.maxAnisotropy)&&void 0!==a?a:1;l>1&&null!==i.device.EXT_texture_filter_anisotropic&&(y(o.minFilter===e.FilterMode.BILINEAR&&o.magFilter===e.FilterMode.BILINEAR&&o.mipmapFilter===e.MipmapFilterMode.LINEAR),s.samplerParameterf(_,i.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l)),i.gl_sampler=_}else i.descriptor=o;return i}return pe(r,t),r.prototype.setTextureParameters=function(t,r,n){var a,o=this.device.gl,i=this.descriptor;this.isNPOT(r,n)?o.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,e.GL.LINEAR):o.texParameteri(t,e.GL.TEXTURE_MIN_FILTER,gt(i.minFilter,i.mipmapFilter)),o.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_S,St(i.addressModeU)),o.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_T,St(i.addressModeV)),o.texParameteri(t,e.GL.TEXTURE_MAG_FILTER,gt(i.magFilter,e.MipmapFilterMode.NO_MIP));var s=null!==(a=i.maxAnisotropy)&&void 0!==a?a:1;s>1&&null!==this.device.EXT_texture_filter_anisotropic&&(y(i.minFilter===e.FilterMode.BILINEAR&&i.magFilter===e.FilterMode.BILINEAR&&i.mipmapFilter===e.MipmapFilterMode.LINEAR),o.texParameteri(t,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s))},r.prototype.destroy=function(){t.prototype.destroy.call(this),Ft(this.device.gl)&&this.device.gl.deleteSampler(Ct(this))},r.prototype.isNPOT=function(e,t){return!z(e)||!z(t)},r}(pt),kt=function(){function e(){}return e.prototype.dispatchWorkgroups=function(e,t,r){},e.prototype.dispatchWorkgroupsIndirect=function(e,t){},e.prototype.setPipeline=function(e){},e.prototype.setBindings=function(e){},e.prototype.pushDebugGroup=function(e){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(e){},e}(),Yt=/uniform(?:\s+)(\w+)(?:\s?){([^]*?)}/g,Kt=function(){function t(t,r){this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=se(Ee),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.currentRenderPassDescriptorStack=[],this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=e.ViewportOrigin.LOWER_LEFT,this.clipSpaceNearZ=e.ClipSpaceNearZ.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=t,this.contextAttributes=b(t.getContextAttributes()),Ft(t)?(this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=t.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=t.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=t.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=t.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=t.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=t.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=t.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=t.getExtension("EXT_color_buffer_half_float"),t.getExtension("EXT_frag_depth"),t.getExtension("OES_element_index_uint"),t.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=t.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=t.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=t.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=t.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=t.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=t.getExtension("KHR_parallel_shader_compile"),Ft(t)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new vt({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:e.TextureDimension.TEXTURE_2D,mipLevelCount:1,usage:e.TextureUsage.RENDER_TARGET,format:!1===this.contextAttributes.alpha?e.Format.U8_RGB_RT:e.Format.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=e.SamplerFormatKind.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(e.TextureDimension.TEXTURE_2D,e.SamplerFormatKind.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(e.TextureDimension.TEXTURE_2D,e.SamplerFormatKind.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:e.BufferUsage.VERTEX,hint:e.BufferFrequencyHint.STATIC}),Ft(t)&&(this.fallbackTexture2DArray=this.createFallbackTexture(e.TextureDimension.TEXTURE_2D_ARRAY,e.SamplerFormatKind.Float),this.fallbackTexture3D=this.createFallbackTexture(e.TextureDimension.TEXTURE_3D,e.SamplerFormatKind.Float),this.fallbackTextureCube=this.createFallbackTexture(e.TextureDimension.TEXTURE_CUBE_MAP,e.SamplerFormatKind.Float)),this.currentMegaState.depthCompare=e.CompareFunction.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=e.ChannelWriteMask.ALL,t.enable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),this.checkLimits(),r.shaderDebug&&(this.shaderDebug=!0),r.trackResources&&(this.resourceCreationTracker=new Ht)}return t.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},t.prototype.createFallbackTexture=function(t,r){var n=t===e.TextureDimension.TEXTURE_CUBE_MAP?6:1,a=this.createTexture({dimension:t,format:r===e.SamplerFormatKind.Depth?e.Format.D32F:e.Format.U8_RGBA_NORM,usage:e.TextureUsage.SAMPLED,width:1,height:1,depthOrArrayLayers:n,mipLevelCount:1});return r===e.SamplerFormatKind.Float&&a.setImageData([new Uint8Array(4*n)]),Bt(a)},t.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},t.prototype.checkLimits=function(){var t=this.gl;if(this.maxVertexAttribs=t.getParameter(e.GL.MAX_VERTEX_ATTRIBS),Ft(t)){this.uniformBufferMaxPageByteSize=Math.min(t.getParameter(e.GL.MAX_UNIFORM_BLOCK_SIZE),65536),this.uniformBufferWordAlignment=t.getParameter(t.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var r=t.getInternalformatParameter(t.RENDERBUFFER,t.DEPTH32F_STENCIL8,t.SAMPLES);this.supportedSampleCounts=r?he([],me(r),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=65536;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort((function(e,t){return e-t}))},t.prototype.configureSwapChain=function(e,t,r){var n=this.scTexture;n.width=e,n.height=t,this.scPlatformFramebuffer=Q(r)},t.prototype.getDevice=function(){return this},t.prototype.getCanvas=function(){return this.gl.canvas},t.prototype.getOnscreenTexture=function(){return this.scTexture},t.prototype.beginFrame=function(){},t.prototype.endFrame=function(){},t.prototype.translateTextureInternalFormat=function(t,r){switch(void 0===r&&(r=!1),t){case e.Format.ALPHA:return e.GL.ALPHA;case e.Format.U8_LUMINANCE:case e.Format.F16_LUMINANCE:case e.Format.F32_LUMINANCE:return e.GL.LUMINANCE;case e.Format.F16_R:return e.GL.R16F;case e.Format.F16_RG:return e.GL.RG16F;case e.Format.F16_RGB:return e.GL.RGB16F;case e.Format.F16_RGBA:return e.GL.RGBA16F;case e.Format.F32_R:return e.GL.R32F;case e.Format.F32_RG:return e.GL.RG32F;case e.Format.F32_RGB:return e.GL.RGB32F;case e.Format.F32_RGBA:return Ft(this.gl)?e.GL.RGBA32F:r?this.WEBGL_color_buffer_float.RGBA32F_EXT:e.GL.RGBA;case e.Format.U8_R_NORM:return e.GL.R8;case e.Format.U8_RG_NORM:return e.GL.RG8;case e.Format.U8_RGB_NORM:case e.Format.U8_RGB_RT:return e.GL.RGB8;case e.Format.U8_RGB_SRGB:return e.GL.SRGB8;case e.Format.U8_RGBA_NORM:case e.Format.U8_RGBA_RT:return Ft(this.gl)?e.GL.RGBA8:r?e.GL.RGBA4:e.GL.RGBA;case e.Format.U8_RGBA:return e.GL.RGBA;case e.Format.U8_RGBA_SRGB:case e.Format.U8_RGBA_RT_SRGB:return e.GL.SRGB8_ALPHA8;case e.Format.U16_R:return e.GL.R16UI;case e.Format.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case e.Format.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case e.Format.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case e.Format.U16_RGBA_5551:return e.GL.RGB5_A1;case e.Format.U16_RGB_565:return e.GL.RGB565;case e.Format.U32_R:return e.GL.R32UI;case e.Format.S8_RGBA_NORM:return e.GL.RGBA8_SNORM;case e.Format.S8_RG_NORM:return e.GL.RG8_SNORM;case e.Format.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case e.Format.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case e.Format.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case e.Format.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case e.Format.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case e.Format.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case e.Format.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case e.Format.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case e.Format.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case e.Format.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case e.Format.D32F_S8:return Ft(this.gl)?e.GL.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?e.GL.DEPTH_STENCIL:e.GL.DEPTH_COMPONENT16;case e.Format.D24_S8:return Ft(this.gl)?e.GL.DEPTH24_STENCIL8:this.WEBGL_depth_texture?e.GL.DEPTH_STENCIL:e.GL.DEPTH_COMPONENT16;case e.Format.D32F:return Ft(this.gl)?e.GL.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?e.GL.DEPTH_COMPONENT:e.GL.DEPTH_COMPONENT16;case e.Format.D24:return Ft(this.gl)?e.GL.DEPTH_COMPONENT24:this.WEBGL_depth_texture?e.GL.DEPTH_COMPONENT:e.GL.DEPTH_COMPONENT16;default:throw Error("whoops")}},t.prototype.translateTextureType=function(t){switch(I(t)){case e.FormatTypeFlags.U8:return e.GL.UNSIGNED_BYTE;case e.FormatTypeFlags.U16:return e.GL.UNSIGNED_SHORT;case e.FormatTypeFlags.U32:return e.GL.UNSIGNED_INT;case e.FormatTypeFlags.S8:return e.GL.BYTE;case e.FormatTypeFlags.F16:return e.GL.HALF_FLOAT;case e.FormatTypeFlags.F32:return e.GL.FLOAT;case e.FormatTypeFlags.U16_PACKED_5551:return e.GL.UNSIGNED_SHORT_5_5_5_1;case e.FormatTypeFlags.D32F:return Ft(this.gl)?e.GL.FLOAT:this.WEBGL_depth_texture?e.GL.UNSIGNED_INT:e.GL.UNSIGNED_BYTE;case e.FormatTypeFlags.D24:return Ft(this.gl)?e.GL.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?e.GL.UNSIGNED_SHORT:e.GL.UNSIGNED_BYTE;case e.FormatTypeFlags.D24S8:return Ft(this.gl)?e.GL.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?e.GL.UNSIGNED_INT_24_8_WEBGL:e.GL.UNSIGNED_BYTE;case e.FormatTypeFlags.D32FS8:return e.GL.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw Error("whoops")}},t.prototype.translateInternalTextureFormat=function(t){switch(t){case e.Format.F32_R:return e.GL.R32F;case e.Format.F32_RG:return e.GL.RG32F;case e.Format.F32_RGB:return e.GL.RGB32F;case e.Format.F32_RGBA:return e.GL.RGBA32F;case e.Format.F16_R:return e.GL.R16F;case e.Format.F16_RG:return e.GL.RG16F;case e.Format.F16_RGB:return e.GL.RGB16F;case e.Format.F16_RGBA:return e.GL.RGBA16F}return this.translateTextureFormat(t)},t.prototype.translateTextureFormat=function(t){if(dt(t)||t===e.Format.F32_LUMINANCE||t===e.Format.U8_LUMINANCE)return this.translateTextureInternalFormat(t);var r=Ft(this.gl)||!Ft(this.gl)&&!!this.WEBGL_depth_texture;switch(t){case e.Format.D24_S8:case e.Format.D32F_S8:return r?e.GL.DEPTH_STENCIL:e.GL.RGBA;case e.Format.D24:case e.Format.D32F:return r?e.GL.DEPTH_COMPONENT:e.GL.RGBA}var n=ft(t);switch(O(t)){case e.FormatCompFlags.A:return e.GL.ALPHA;case e.FormatCompFlags.R:return n?e.GL.RED_INTEGER:e.GL.RED;case e.FormatCompFlags.RG:return n?e.GL.RG_INTEGER:e.GL.RG;case e.FormatCompFlags.RGB:return n?e.GL.RGB_INTEGER:e.GL.RGB;case e.FormatCompFlags.RGBA:return e.GL.RGBA}},t.prototype.setActiveTexture=function(e){this.currentActiveTexture!==e&&(this.gl.activeTexture(e),this.currentActiveTexture=e)},t.prototype.bindVAO=function(e){this.currentBoundVAO!==e&&(Ft(this.gl)?this.gl.bindVertexArray(e):this.OES_vertex_array_object.bindVertexArrayOES(e),this.currentBoundVAO=e)},t.prototype.programCompiled=function(e){y(e.compileState!==Dt.NeedsCompile),e.compileState===Dt.Compiling&&(e.compileState=Dt.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(e))},t.prototype.useProgram=function(e){this.currentProgram!==e&&(this.programCompiled(e),this.gl.useProgram(e.gl_program),this.currentProgram=e)},t.prototype.ensureResourceExists=function(e){if(null===e){var t=this.gl.getError();throw Error("Created resource is null; GL error encountered: ".concat(t))}return e},t.prototype.createBuffer=function(e){return new Gt({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createTexture=function(e){return new vt({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createSampler=function(e){return new Vt({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderTarget=function(e){return new yt({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderTargetFromTexture=function(e){var t=e.format,r=e.width,n=e.height;return y(1===e.mipLevelCount),this.createRenderTarget({format:t,width:r,height:n,sampleCount:1,texture:e})},t.prototype.createProgram=function(e){var t,r,n,a=null===(t=e.vertex)||void 0===t?void 0:t.glsl;return(null===(r=e.vertex)||void 0===r?void 0:r.glsl)&&(e.vertex.glsl=ut(this.queryVendorInfo(),"vert",e.vertex.glsl)),(null===(n=e.fragment)||void 0===n?void 0:n.glsl)&&(e.fragment.glsl=ut(this.queryVendorInfo(),"frag",e.fragment.glsl)),this.createProgramSimple(e,a)},t.prototype.createProgramSimple=function(e,t){return new bt({id:this.getNextUniqueId(),device:this,descriptor:e},t)},t.prototype.createBindings=function(e){return new At({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createInputLayout=function(e){return new Pt({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderPipeline=function(e){return new wt({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createComputePass=function(){return new kt},t.prototype.createComputePipeline=function(e){return new Wt({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createReadback=function(){return new Xt({id:this.getNextUniqueId(),device:this})},t.prototype.createQueryPool=function(e,t){return new xt({id:this.getNextUniqueId(),device:this,descriptor:{type:e,elemCount:t}})},t.prototype.formatRenderPassDescriptor=function(e){var t,r,n,a,o,i,s=e.colorAttachment;e.depthClearValue=null!==(t=e.depthClearValue)&&void 0!==t?t:"load",e.stencilClearValue=null!==(r=e.stencilClearValue)&&void 0!==r?r:"load";for(var _=0;s.length>_;_++)e.colorAttachmentLevel||(e.colorAttachmentLevel=[]),e.colorAttachmentLevel[_]=null!==(n=e.colorAttachmentLevel[_])&&void 0!==n?n:0,e.colorResolveToLevel||(e.colorResolveToLevel=[]),e.colorResolveToLevel[_]=null!==(a=e.colorResolveToLevel[_])&&void 0!==a?a:0,e.colorClearColor||(e.colorClearColor=[]),e.colorClearColor[_]=null!==(o=e.colorClearColor[_])&&void 0!==o?o:"load",e.colorStore||(e.colorStore=[]),e.colorStore[_]=null!==(i=e.colorStore[_])&&void 0!==i&&i},t.prototype.createRenderPass=function(e){null!==this.currentRenderPassDescriptor&&this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=e,this.formatRenderPassDescriptor(e);var t=e.colorAttachment,r=e.colorAttachmentLevel,n=e.colorClearColor,a=e.colorResolveTo,o=e.colorResolveToLevel,i=e.depthStencilAttachment,s=e.depthClearValue,_=e.stencilClearValue,l=e.depthStencilResolveTo;this.setRenderPassParametersBegin(t.length);for(var E=0;t.length>E;E++)this.setRenderPassParametersColor(E,t[E],r[E],a[E],o[E]);this.setRenderPassParametersDepthStencil(i,l),this.validateCurrentAttachments();for(E=0;t.length>E;E++){var u=n[E];"load"!==u&&this.setRenderPassParametersClearColor(E,u.r,u.g,u.b,u.a)}return this.setRenderPassParametersClearDepthStencil(s,_),this},t.prototype.submitPass=function(e){y(null!==this.currentRenderPassDescriptor),this.endPass(),this.currentRenderPassDescriptor=this.currentRenderPassDescriptorStack.length?this.currentRenderPassDescriptorStack.pop():null},t.prototype.copySubTexture2D=function(e,t,r,n,a,o){var i=this.gl,s=e,_=n;if(y(1===_.mipLevelCount),y(1===s.mipLevelCount),Ft(i))s===this.scTexture?i.bindFramebuffer(i.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(i.bindFramebuffer(i.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,s,0)),i.bindFramebuffer(i.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,_,0),i.blitFramebuffer(a,o,a+_.width,o+_.height,t,r,t+_.width,r+_.height,i.COLOR_BUFFER_BIT,i.LINEAR),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null);else if(s===this.scTexture){var l=this.createRenderTargetFromTexture(n);this.submitBlitRenderPass(l,s)}},t.prototype.queryLimits=function(){return this},t.prototype.queryTextureFormatSupported=function(t,r,n){switch(t){case e.Format.BC1_SRGB:case e.Format.BC2_SRGB:case e.Format.BC3_SRGB:return null!==this.WEBGL_compressed_texture_s3tc_srgb&&Ut(r,n,4,4);case e.Format.BC1:case e.Format.BC2:case e.Format.BC3:return null!==this.WEBGL_compressed_texture_s3tc&&Ut(r,n,4,4);case e.Format.BC4_UNORM:case e.Format.BC4_SNORM:case e.Format.BC5_UNORM:case e.Format.BC5_SNORM:return null!==this.EXT_texture_compression_rgtc&&Ut(r,n,4,4);case e.Format.U16_R_NORM:case e.Format.U16_RG_NORM:case e.Format.U16_RGBA_NORM:return null!==this.EXT_texture_norm16;case e.Format.F32_R:case e.Format.F32_RG:case e.Format.F32_RGB:case e.Format.F32_RGBA:return null!==this.OES_texture_float_linear;case e.Format.F16_R:case e.Format.F16_RG:case e.Format.F16_RGB:case e.Format.F16_RGBA:return null!==this.OES_texture_half_float_linear;default:return!0}},t.prototype.queryProgramReady=function(e){var t=this.gl;if(e.compileState===Dt.NeedsCompile)throw Error("whoops");if(e.compileState===Dt.Compiling){var r=void 0;return(r=null===this.KHR_parallel_shader_compile||t.getProgramParameter(e.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR))&&this.programCompiled(e),r}return e.compileState===Dt.NeedsBind||e.compileState===Dt.ReadyToUse},t.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},t.prototype.queryVendorInfo=function(){return this},t.prototype.queryRenderPass=function(e){return this.currentRenderPassDescriptor},t.prototype.queryRenderTarget=function(e){return e},t.prototype.setResourceName=function(t,r){if(t.name=r,t.type===e.ResourceType.Buffer)for(var n=t.gl_buffer_pages,a=0;n.length>a;a++)Lt(n[a],"".concat(r," Page ").concat(a));else if(t.type===e.ResourceType.Texture)Lt(Bt(t),r);else if(t.type===e.ResourceType.Sampler)Lt(Ct(t),r);else if(t.type===e.ResourceType.RenderTarget){var o=t.gl_renderbuffer;null!==o&&Lt(o,r)}else t.type===e.ResourceType.InputLayout&&Lt(t.vao,r)},t.prototype.setResourceLeakCheck=function(e,t){null!==this.resourceCreationTracker&&this.resourceCreationTracker.setResourceLeakCheck(e,t)},t.prototype.checkForLeaks=function(){null!==this.resourceCreationTracker&&this.resourceCreationTracker.checkForLeaks()},t.prototype.pushDebugGroup=function(e){},t.prototype.popDebugGroup=function(){},t.prototype.insertDebugMarker=function(e){},t.prototype.programPatched=function(e,t){y(this.shaderDebug)},t.prototype.getBufferData=function(e,t,r){void 0===r&&(r=0);var n=this.gl;Ft(n)&&(n.bindBuffer(n.COPY_READ_BUFFER,Nt(e,4*r)),n.getBufferSubData(n.COPY_READ_BUFFER,4*r,t))},t.prototype.debugGroupStatisticsDrawCall=function(e){void 0===e&&(e=1);for(var t=this.debugGroupStack.length-1;t>=0;t--)this.debugGroupStack[t].drawCallCount+=e},t.prototype.debugGroupStatisticsBufferUpload=function(e){void 0===e&&(e=1);for(var t=this.debugGroupStack.length-1;t>=0;t--)this.debugGroupStack[t].bufferUploadCount+=e},t.prototype.debugGroupStatisticsTextureBind=function(e){void 0===e&&(e=1);for(var t=this.debugGroupStack.length-1;t>=0;t--)this.debugGroupStack[t].textureBindCount+=e},t.prototype.debugGroupStatisticsTriangles=function(e){for(var t=this.debugGroupStack.length-1;t>=0;t--)this.debugGroupStack[t].triangleCount+=e},t.prototype.reportShaderError=function(e,t){var r=this.gl,n=r.getShaderParameter(e,r.COMPILE_STATUS);if(!n){console.error(ee(t));var a=r.getExtension("WEBGL_debug_shaders");a&&console.error(a.getTranslatedShaderSource(e)),console.error(r.getShaderInfoLog(e))}return n},t.prototype.checkProgramCompilationForErrors=function(e){var t=this.gl;if(!t.getProgramParameter(e.gl_program,t.LINK_STATUS)){var r=e.descriptor;if(!this.reportShaderError(e.gl_shader_vert,r.vertex.glsl))return;if(!this.reportShaderError(e.gl_shader_frag,r.fragment.glsl))return;console.error(t.getProgramInfoLog(e.gl_program))}},t.prototype.bindFramebufferAttachment=function(t,r,n,a){var o=this.gl;if(ge(n))o.framebufferRenderbuffer(t,r,o.RENDERBUFFER,null);else if(n.type===e.ResourceType.RenderTarget)null!==n.gl_renderbuffer?o.framebufferRenderbuffer(t,r,o.RENDERBUFFER,n.gl_renderbuffer):null!==n.texture&&o.framebufferTexture2D(t,r,e.GL.TEXTURE_2D,Bt(n.texture),a);else if(n.type===e.ResourceType.Texture){var i=Bt(n);n.dimension===e.TextureDimension.TEXTURE_2D?o.framebufferTexture2D(t,r,e.GL.TEXTURE_2D,i,a):Ft(o)}},t.prototype.bindFramebufferDepthStencilAttachment=function(t,r){var n=this.gl,a=ge(r)?e.FormatFlags.Depth|e.FormatFlags.Stencil:U(r.format),o=!!(a&e.FormatFlags.Depth),i=!!(a&e.FormatFlags.Stencil);if(o&&i){var s=Ft(this.gl)||!Ft(this.gl)&&!!this.WEBGL_depth_texture;this.bindFramebufferAttachment(t,s?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,r,0)}else o?(this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,null,0)):i&&(this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,null,0))},t.prototype.validateCurrentAttachments=function(){for(var e=-1,t=-1,r=-1,n=0;this.currentColorAttachments.length>n;n++){var a=this.currentColorAttachments[n];null!==a&&(-1===e?(e=a.sampleCount,t=a.width,r=a.height):(y(e===a.sampleCount),y(t===a.width),y(r===a.height)))}this.currentDepthStencilAttachment&&(-1===e?e=this.currentDepthStencilAttachment.sampleCount:(y(e===this.currentDepthStencilAttachment.sampleCount),y(t===this.currentDepthStencilAttachment.width),y(r===this.currentDepthStencilAttachment.height))),this.currentSampleCount=e},t.prototype.setRenderPassParametersBegin=function(t){var r=this.gl;if(Ft(r)?r.bindFramebuffer(e.GL.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||r.bindFramebuffer(e.GL.FRAMEBUFFER,this.renderPassDrawFramebuffer),Ft(r)?r.drawBuffers([e.GL.COLOR_ATTACHMENT0,e.GL.COLOR_ATTACHMENT1,e.GL.COLOR_ATTACHMENT2,e.GL.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([e.GL.COLOR_ATTACHMENT0_WEBGL,e.GL.COLOR_ATTACHMENT1_WEBGL,e.GL.COLOR_ATTACHMENT2_WEBGL,e.GL.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var n=t;this.currentColorAttachments.length>n;n++){var a=Ft(r)?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,o=Ft(r)?e.GL.COLOR_ATTACHMENT0:e.GL.COLOR_ATTACHMENT0_WEBGL;r.framebufferRenderbuffer(a,o+n,e.GL.RENDERBUFFER,null),r.framebufferTexture2D(a,o+n,e.GL.TEXTURE_2D,null,0)}this.currentColorAttachments.length=t},t.prototype.setRenderPassParametersColor=function(t,r,n,a,o){var i=Ft(this.gl);this.currentColorAttachments[t]===r&&this.currentColorAttachmentLevels[t]===n||(this.currentColorAttachments[t]=r,this.currentColorAttachmentLevels[t]=n,(i||!i&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(i?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,(i?e.GL.COLOR_ATTACHMENT0:e.GL.COLOR_ATTACHMENT0_WEBGL)+t,r,n),this.resolveColorAttachmentsChanged=!0),this.currentColorResolveTos[t]===a&&this.currentColorResolveToLevels[t]===o||(this.currentColorResolveTos[t]=a,this.currentColorResolveToLevels[t]=o,null!==a&&(this.resolveColorAttachmentsChanged=!0))},t.prototype.setRenderPassParametersDepthStencil=function(t,r){var n=this.gl;this.currentDepthStencilAttachment!==t&&(this.currentDepthStencilAttachment=t,this.inBlitRenderPass||this.bindFramebufferDepthStencilAttachment(Ft(n)?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==r&&(this.currentDepthStencilResolveTo=r,r&&(this.resolveDepthStencilAttachmentsChanged=!0))},t.prototype.setRenderPassParametersClearColor=function(t,r,n,a,o){var i,s=this.gl;null!==this.OES_draw_buffers_indexed?(i=this.currentMegaState.attachmentsState[t])&&i.channelWriteMask!==e.ChannelWriteMask.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(t,!0,!0,!0,!0),i.channelWriteMask=e.ChannelWriteMask.ALL):(i=this.currentMegaState.attachmentsState[0])&&i.channelWriteMask!==e.ChannelWriteMask.ALL&&(s.colorMask(!0,!0,!0,!0),i.channelWriteMask=e.ChannelWriteMask.ALL);this.setScissorRectEnabled(!1),Ft(s)?s.clearBufferfv(s.COLOR,t,[r,n,a,o]):(s.clearColor(r,n,a,o),s.clear(s.COLOR_BUFFER_BIT))},t.prototype.setRenderPassParametersClearDepthStencil=function(e,t){void 0===e&&(e="load"),void 0===t&&(t="load");var r=this.gl;"load"!==e&&(y(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(r.depthMask(!0),this.currentMegaState.depthWrite=!0),Ft(r)?r.clearBufferfv(r.DEPTH,0,[e]):(r.clearDepth(e),r.clear(r.DEPTH_BUFFER_BIT))),"load"!==t&&(y(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(r.enable(r.STENCIL_TEST),r.stencilMask(255),this.currentMegaState.stencilWrite=!0),Ft(r)?r.clearBufferiv(r.STENCIL,0,[t]):(r.clearStencil(t),r.clear(r.STENCIL_BUFFER_BIT)))},t.prototype.setBindings=function(e){var t,r=this.gl,n=e.uniformBufferBindings,a=e.samplerBindings,o=e.bindingLayouts;y(o.bindingLayoutTables.length>0);var i=o.bindingLayoutTables[0];y(n.length>=i.numUniformBuffers),y(a.length>=i.numSamplers);for(var s=0;n.length>s;s++){if(0!==(T=n[s]).size){var _=i.firstUniformBuffer+s,l=T.buffer,E=T.offset||0,u=T.size||l.byteSize;if(l!==this.currentUniformBuffers[_]||E!==this.currentUniformBufferByteOffsets[_]||u!==this.currentUniformBufferByteSizes[_]){var c=E%l.pageByteSize,R=l.gl_buffer_pages[E/l.pageByteSize|0];y(l.pageByteSize>=c+u),Ft(r)&&r.bindBufferRange(r.UNIFORM_BUFFER,_,R,c,u),this.currentUniformBuffers[_]=l,this.currentUniformBufferByteOffsets[_]=E,this.currentUniformBufferByteSizes[_]=u}}}for(s=0;i.numSamplers>s;s++){var T,p=i.firstSampler+s,A=null!==(T=a[s])&&null!==T.sampler?Ct(T.sampler):null,F=null!==T&&null!==T.texture?Bt(T.texture):null;if(this.currentSamplers[p]!==A&&(Ft(r)&&r.bindSampler(p,A),this.currentSamplers[p]=A),this.currentTextures[p]!==F){if(this.setActiveTexture(r.TEXTURE0+p),null!==F){var d=b(T).texture,f=d.gl_target,m=d.width,h=d.height;T.texture.textureIndex=p,r.bindTexture(f,F),Ft(r)||null===(t=T.sampler)||void 0===t||t.setTextureParameters(f,m,h),this.debugGroupStatisticsTextureBind()}else{var S=Ae(Ae({},T),Re),g=S.formatKind;f=It(S.dimension);r.bindTexture(f,this.getFallbackTexture(Ae({gl_target:f,formatKind:g},S)))}this.currentTextures[p]=F}}},t.prototype.setViewport=function(e,t,r,n){this.gl.viewport(e,t,r,n)},t.prototype.setScissorRect=function(e,t,r,n){var a=this.gl;this.setScissorRectEnabled(!0),a.scissor(e,t,r,n)},t.prototype.applyAttachmentStateIndexed=function(t,r,n){var a=this.gl,o=this.OES_draw_buffers_indexed;r.channelWriteMask!==n.channelWriteMask&&(o.colorMaskiOES(t,!!(n.channelWriteMask&e.ChannelWriteMask.RED),!!(n.channelWriteMask&e.ChannelWriteMask.GREEN),!!(n.channelWriteMask&e.ChannelWriteMask.BLUE),!!(n.channelWriteMask&e.ChannelWriteMask.ALPHA)),r.channelWriteMask=n.channelWriteMask);var i=r.rgbBlendState.blendMode!==n.rgbBlendState.blendMode||r.alphaBlendState.blendMode!==n.alphaBlendState.blendMode,s=r.rgbBlendState.blendSrcFactor!==n.rgbBlendState.blendSrcFactor||r.alphaBlendState.blendSrcFactor!==n.alphaBlendState.blendSrcFactor||r.rgbBlendState.blendDstFactor!==n.rgbBlendState.blendDstFactor||r.alphaBlendState.blendDstFactor!==n.alphaBlendState.blendDstFactor;(s||i)&&(Ot(r.rgbBlendState)&&Ot(r.alphaBlendState)?o.enableiOES(t,a.BLEND):Ot(n.rgbBlendState)&&Ot(n.alphaBlendState)&&o.disableiOES(t,a.BLEND)),i&&(o.blendEquationSeparateiOES(t,n.rgbBlendState.blendMode,n.alphaBlendState.blendMode),r.rgbBlendState.blendMode=n.rgbBlendState.blendMode,r.alphaBlendState.blendMode=n.alphaBlendState.blendMode),s&&(o.blendFuncSeparateiOES(t,n.rgbBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor,n.alphaBlendState.blendSrcFactor,n.alphaBlendState.blendDstFactor),r.rgbBlendState.blendSrcFactor=n.rgbBlendState.blendSrcFactor,r.alphaBlendState.blendSrcFactor=n.alphaBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor=n.rgbBlendState.blendDstFactor,r.alphaBlendState.blendDstFactor=n.alphaBlendState.blendDstFactor)},t.prototype.applyAttachmentState=function(t,r){var n=this.gl;t.channelWriteMask!==r.channelWriteMask&&(n.colorMask(!!(r.channelWriteMask&e.ChannelWriteMask.RED),!!(r.channelWriteMask&e.ChannelWriteMask.GREEN),!!(r.channelWriteMask&e.ChannelWriteMask.BLUE),!!(r.channelWriteMask&e.ChannelWriteMask.ALPHA)),t.channelWriteMask=r.channelWriteMask);var a=t.rgbBlendState.blendMode!==r.rgbBlendState.blendMode||t.alphaBlendState.blendMode!==r.alphaBlendState.blendMode,o=t.rgbBlendState.blendSrcFactor!==r.rgbBlendState.blendSrcFactor||t.alphaBlendState.blendSrcFactor!==r.alphaBlendState.blendSrcFactor||t.rgbBlendState.blendDstFactor!==r.rgbBlendState.blendDstFactor||t.alphaBlendState.blendDstFactor!==r.alphaBlendState.blendDstFactor;(o||a)&&(Ot(t.rgbBlendState)&&Ot(t.alphaBlendState)?n.enable(n.BLEND):Ot(r.rgbBlendState)&&Ot(r.alphaBlendState)&&n.disable(n.BLEND)),a&&(n.blendEquationSeparate(r.rgbBlendState.blendMode,r.alphaBlendState.blendMode),t.rgbBlendState.blendMode=r.rgbBlendState.blendMode,t.alphaBlendState.blendMode=r.alphaBlendState.blendMode),o&&(n.blendFuncSeparate(r.rgbBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor,r.alphaBlendState.blendSrcFactor,r.alphaBlendState.blendDstFactor),t.rgbBlendState.blendSrcFactor=r.rgbBlendState.blendSrcFactor,t.alphaBlendState.blendSrcFactor=r.alphaBlendState.blendSrcFactor,t.rgbBlendState.blendDstFactor=r.rgbBlendState.blendDstFactor,t.alphaBlendState.blendDstFactor=r.alphaBlendState.blendDstFactor)},t.prototype.setMegaState=function(t){var r=this.gl,n=this.currentMegaState;if(null!==this.OES_draw_buffers_indexed)for(var a=0;t.attachmentsState.length>a;a++)this.applyAttachmentStateIndexed(a,n.attachmentsState[0],t.attachmentsState[0]);else y(1===t.attachmentsState.length),this.applyAttachmentState(n.attachmentsState[0],t.attachmentsState[0]);if(x(n.blendConstant,t.blendConstant)||(r.blendColor(t.blendConstant.r,t.blendConstant.g,t.blendConstant.b,t.blendConstant.a),X(n.blendConstant,t.blendConstant)),n.depthCompare!==t.depthCompare&&(r.depthFunc(t.depthCompare),n.depthCompare=t.depthCompare),!!n.depthWrite!=!!t.depthWrite&&(r.depthMask(t.depthWrite),n.depthWrite=t.depthWrite),!!n.stencilWrite!=!!t.stencilWrite&&(r.stencilMask(t.stencilWrite?255:0),n.stencilWrite=t.stencilWrite),!Pe(n.stencilFront,t.stencilFront)){var o=t.stencilFront,i=o.failOp,s=o.depthFailOp,_=o.compare;n.stencilFront.passOp===(l=o.passOp)&&n.stencilFront.failOp===i&&n.stencilFront.depthFailOp===s||(r.stencilOpSeparate(r.FRONT,i,s,l),n.stencilFront.passOp=l,n.stencilFront.failOp=i,n.stencilFront.depthFailOp=s),n.stencilFront.compare!==_&&(this.setStencilReference(0),n.stencilFront.compare=_)}if(!Pe(n.stencilBack,t.stencilBack)){var l,E=t.stencilBack;i=E.failOp,s=E.depthFailOp,_=E.compare;n.stencilBack.passOp===(l=E.passOp)&&n.stencilBack.failOp===i&&n.stencilBack.depthFailOp===s||(r.stencilOpSeparate(r.BACK,i,s,l),n.stencilBack.passOp=l,n.stencilBack.failOp=i,n.stencilBack.depthFailOp=s),n.stencilBack.compare!==_&&(this.setStencilReference(0),n.stencilBack.compare=_)}n.cullMode!==t.cullMode&&(n.cullMode===e.CullMode.NONE?r.enable(r.CULL_FACE):t.cullMode===e.CullMode.NONE&&r.disable(r.CULL_FACE),t.cullMode===e.CullMode.BACK?r.cullFace(r.BACK):t.cullMode===e.CullMode.FRONT?r.cullFace(r.FRONT):t.cullMode===e.CullMode.FRONT_AND_BACK&&r.cullFace(r.FRONT_AND_BACK),n.cullMode=t.cullMode),n.frontFace!==t.frontFace&&(r.frontFace(t.frontFace),n.frontFace=t.frontFace),n.polygonOffset!==t.polygonOffset&&(t.polygonOffset?(r.polygonOffset(1,1),r.enable(r.POLYGON_OFFSET_FILL)):r.disable(r.POLYGON_OFFSET_FILL),n.polygonOffset=t.polygonOffset)},t.prototype.validatePipelineFormats=function(e){for(var t=0;this.currentColorAttachments.length>t;t++);this.currentDepthStencilAttachment&&y(this.currentDepthStencilAttachment.format===e.depthStencilAttachmentFormat),-1!==this.currentSampleCount&&y(this.currentSampleCount===e.sampleCount)},t.prototype.setPipeline=function(e){this.currentPipeline=e,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var t=this.currentPipeline.program;if(this.useProgram(t),t.compileState===Dt.NeedsBind){var r=this.gl,n=t.gl_program,a=t.descriptor,o=Mt(a.vertex.glsl,Yt);if(Ft(r))for(var i=0;o.length>i;i++){var s=me(o[i],2),_=r.getUniformBlockIndex(n,s[1]);-1!==_&&4294967295!==_&&r.uniformBlockBinding(n,_,i)}var l=Mt(a.fragment.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm);for(i=0;l.length>i;i++){var E=me(l[i],3),u=E[2],c=r.getUniformLocation(n,E[1]);r.uniform1i(c,parseInt(u))}t.compileState=Dt.ReadyToUse}},t.prototype.setVertexInput=function(t,r,n){var a,o,i;if(null!==t){y(this.currentPipeline.inputLayout===t);var s=t;this.bindVAO(s.vao);for(var _=this.gl,l=0;s.vertexBufferDescriptors.length>l;l++){var E=s.vertexBufferDescriptors[l],u=E.arrayStride,c=E.attributes;try{for(var R=(a=void 0,fe(c)),T=R.next();!T.done;T=R.next()){var p=T.value,A=p.shaderLocation,F=p.offset,d=Ft(_)?A:null===(i=s.program.attributes[A])||void 0===i?void 0:i.location;if(!ge(d)){var f=r[l];if(null===f)continue;var m=p.vertexFormat;_.bindBuffer(_.ARRAY_BUFFER,Nt(f.buffer)),_.vertexAttribPointer(d,m.size,m.type,m.normalized,u,(f.offset||0)+F)}}}catch(e){a={error:e}}finally{try{T&&!T.done&&(o=R.return)&&o.call(R)}finally{if(a)throw a.error}}}if(y(null!==n==(null!==s.indexBufferFormat)),null!==n){var h=n.buffer;y(h.usage===e.BufferUsage.INDEX),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,Nt(h)),this.currentIndexBufferByteOffset=n.offset||0}else this.currentIndexBufferByteOffset=null}else y(null===this.currentPipeline.inputLayout),y(null===n),this.bindVAO(null),this.currentIndexBufferByteOffset=0},t.prototype.setStencilReference=function(e){this.currentStencilRef!==e&&(this.currentStencilRef=e,this.applyStencil())},t.prototype.draw=function(e,t,r,n){var a,o=this.gl,i=this.currentPipeline;if(t){var s=[i.drawMode,r||0,e,t];Ft(o)?o.drawArraysInstanced.apply(o,he([],me(s),!1)):(a=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(a,he([],me(s),!1))}else o.drawArrays(i.drawMode,r,e);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(e/3*Math.max(t,1))},t.prototype.drawIndexed=function(e,t,r,n,a){var o,i=this.gl,s=this.currentPipeline,_=b(s.inputLayout),l=b(this.currentIndexBufferByteOffset)+r*_.indexBufferCompByteSize;if(t){var E=[s.drawMode,e,_.indexBufferType,l,t];Ft(i)?i.drawElementsInstanced.apply(i,he([],me(E),!1)):(o=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(o,he([],me(E),!1))}else i.drawElements(s.drawMode,e,_.indexBufferType,l);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(e/3*Math.max(t,1))},t.prototype.drawIndirect=function(e,t){},t.prototype.drawIndexedIndirect=function(e,t){},t.prototype.beginOcclusionQuery=function(e){var t=this.gl;if(Ft(t)){var r=this.currentRenderPassDescriptor.occlusionQueryPool;t.beginQuery(r.gl_query_type,r.gl_query[e])}},t.prototype.endOcclusionQuery=function(){var e=this.gl;Ft(e)&&e.endQuery(this.currentRenderPassDescriptor.occlusionQueryPool.gl_query_type)},t.prototype.pipelineQueryReady=function(e){return this.queryProgramReady(e.program)},t.prototype.pipelineForceReady=function(e){},t.prototype.endPass=function(){for(var t=this.gl,r=Ft(t),n=!1,a=0;this.currentColorAttachments.length>a;a++){var o=this.currentColorAttachments[a];if(null!==o){var i=this.currentColorResolveTos[a],s=!1;null!==i&&(y(o.width===i.width&&o.height===i.height),this.setScissorRectEnabled(!1),r&&t.bindFramebuffer(t.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&r&&this.bindFramebufferAttachment(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,o,this.currentColorAttachmentLevels[a]),s=!0,i===this.scTexture?t.bindFramebuffer(r?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,this.scPlatformFramebuffer):(t.bindFramebuffer(r?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&t.framebufferTexture2D(r?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i.gl_texture,this.currentColorResolveToLevels[a])),r?(t.blitFramebuffer(0,0,o.width,o.height,0,0,i.width,i.height,t.COLOR_BUFFER_BIT,t.LINEAR),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(o,i),n=!0),this.currentRenderPassDescriptor.colorStore[a]||s||(t.bindFramebuffer(r?e.GL.READ_FRAMEBUFFER:e.GL.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(r?e.GL.READ_FRAMEBUFFER:e.GL.FRAMEBUFFER,t.COLOR_ATTACHMENT0,o,this.currentColorAttachmentLevels[a])),t.bindFramebuffer(r?e.GL.READ_FRAMEBUFFER:e.GL.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var _=this.currentDepthStencilAttachment;if(_){var l=this.currentDepthStencilResolveTo;s=!1;l&&(y(_.width===l.width&&_.height===l.height),this.setScissorRectEnabled(!1),t.bindFramebuffer(r?e.GL.READ_FRAMEBUFFER:e.GL.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),t.bindFramebuffer(r?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(r?e.GL.READ_FRAMEBUFFER:e.GL.FRAMEBUFFER,_),this.bindFramebufferDepthStencilAttachment(r?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,l)),s=!0,r&&t.blitFramebuffer(0,0,_.width,_.height,0,0,l.width,l.height,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(r?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,null),n=!0),this.currentRenderPassDescriptor.depthStencilStore||(s||(t.bindFramebuffer(r?e.GL.READ_FRAMEBUFFER:e.GL.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(r?e.GL.READ_FRAMEBUFFER:e.GL.FRAMEBUFFER,_),s=!0),r&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[t.DEPTH_STENCIL_ATTACHMENT])),s&&t.bindFramebuffer(r?e.GL.READ_FRAMEBUFFER:e.GL.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}n||t.bindFramebuffer(r?e.GL.DRAW_FRAMEBUFFER:e.GL.FRAMEBUFFER,null)},t.prototype.setScissorRectEnabled=function(e){if(this.currentScissorEnabled!==e){var t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST),this.currentScissorEnabled=e}},t.prototype.applyStencil=function(){ge(this.currentStencilRef)||(this.gl.stencilFuncSeparate(e.GL.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,255),this.gl.stencilFuncSeparate(e.GL.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,255))},t.prototype.getFallbackTexture=function(t){var r=t.gl_target;if(r===e.GL.TEXTURE_2D)return t.formatKind===e.SamplerFormatKind.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===e.GL.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===e.GL.TEXTURE_3D)return this.fallbackTexture3D;if(r===e.GL.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw Error("whoops")},t.prototype.submitBlitRenderPass=function(t,r){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:"layout(location = 0) in vec2 a_Position;\nout vec2 v_TexCoord;\nvoid main() {\n  v_TexCoord = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_TexCoord.y = 1.0 - v_TexCoord.y;\n  #endif\n}"},fragment:{glsl:"uniform sampler2D u_Texture;\nin vec2 v_TexCoord;\nout vec4 outputColor;\nvoid main() {\n  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);\n}"}}),this.blitVertexBuffer=this.createBuffer({usage:e.BufferUsage.VERTEX|e.BufferUsage.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:8,stepMode:e.VertexStepMode.VERTEX,attributes:[{format:e.Format.F32_RG,offset:0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:e.PrimitiveTopology.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[e.Format.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:se(Ee)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:t.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:t}));var n=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var a=this.createRenderPass({colorAttachment:[t],colorResolveTo:[r],colorClearColor:[k]}),o=this.getCanvas(),i=o.width,s=o.height;a.setPipeline(this.blitRenderPipeline),a.setBindings(this.blitBindings),a.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),a.setViewport(0,0,i,s),this.gl.disable(this.gl.BLEND),a.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=n,this.inBlitRenderPass=!1},t}(),qt=function(){function e(e){this.pluginOptions=e}return e.prototype.createSwapChain=function(e){return Fe(this,void 0,void 0,(function(){var t,r,n,a,o,i,s;return de(this,(function(_){return r=(t=this.pluginOptions).targets,i={antialias:void 0!==(n=t.antialias)&&n,preserveDrawingBuffer:void 0!==(a=t.preserveDrawingBuffer)&&a,stencil:!0,premultipliedAlpha:void 0===(o=t.premultipliedAlpha)||o,xrCompatible:t.xrCompatible},this.handleContextEvents(e),r.includes("webgl2")&&(s=e.getContext("webgl2",i)||e.getContext("experimental-webgl2",i)),!s&&r.includes("webgl1")&&(s=e.getContext("webgl",i)||e.getContext("experimental-webgl",i)),[2,new Kt(s,{shaderDebug:!0,trackResources:!0})]}))}))},e.prototype.handleContextEvents=function(e){var t=this.pluginOptions,r=t.onContextLost,n=t.onContextRestored,a=t.onContextCreationError;a&&e.addEventListener("webglcontextcreationerror",a,!1),r&&e.addEventListener("webglcontextlost",r,!1),n&&e.addEventListener("webglcontextrestored",n,!1)},e}();let zt;const Zt="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&Zt.decode();let Qt=null;function jt(){return null!==Qt&&0!==Qt.byteLength||(Qt=new Uint8Array(zt.memory.buffer)),Qt}function $t(e,t){return e>>>=0,Zt.decode(jt().subarray(e,e+t))}const Jt=Array(128).fill(void 0);Jt.push(void 0,null,!0,!1);let er=Jt.length;function tr(e){return Jt[e]}function rr(e){const t=tr(e);return function(e){132>e||(Jt[e]=er,er=e)}(e),t}let nr=0;const ar="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},or="function"==typeof ar.encodeInto?function(e,t){return ar.encodeInto(e,t)}:function(e,t){const r=ar.encode(e);return t.set(r),{read:e.length,written:r.length}};function ir(e,t,r){if(void 0===r){const r=ar.encode(e),n=t(r.length,1)>>>0;return jt().subarray(n,n+r.length).set(r),nr=r.length,n}let n=e.length,a=t(n,1)>>>0;const o=jt();let i=0;for(;n>i;i++){const t=e.charCodeAt(i);if(t>127)break;o[a+i]=t}if(i!==n){0!==i&&(e=e.slice(i)),a=r(a,n,n=i+3*e.length,1)>>>0;const t=jt().subarray(a+i,a+n);i+=or(e,t).written}return nr=i,a}let sr=null;function _r(){return null!==sr&&0!==sr.byteLength||(sr=new Int32Array(zt.memory.buffer)),sr}function lr(e,t,r){let n,a;try{const s=zt.__wbindgen_add_to_stack_pointer(-16),_=ir(e,zt.__wbindgen_malloc,zt.__wbindgen_realloc),l=nr,E=ir(t,zt.__wbindgen_malloc,zt.__wbindgen_realloc);zt.glsl_compile(s,_,l,E,nr,r);var o=_r()[s/4+0],i=_r()[s/4+1];return n=o,a=i,$t(o,i)}finally{zt.__wbindgen_add_to_stack_pointer(16),zt.__wbindgen_free(n,a,1)}}class Er{static __wrap(e){e>>>=0;const t=Object.create(Er.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();zt.__wbg_wgslcomposer_free(e)}constructor(){const e=zt.wgslcomposer_new();return Er.__wrap(e)}wgsl_compile(e){let t,r;try{const o=zt.__wbindgen_add_to_stack_pointer(-16),i=ir(e,zt.__wbindgen_malloc,zt.__wbindgen_realloc);zt.wgslcomposer_wgsl_compile(o,this.__wbg_ptr,i,nr);var n=_r()[o/4+0],a=_r()[o/4+1];return t=n,r=a,$t(n,a)}finally{zt.__wbindgen_add_to_stack_pointer(16),zt.__wbindgen_free(t,r,1)}}}function ur(){const e={wbg:{}};return e.wbg.__wbindgen_string_new=function(e,t){return function(e){er===Jt.length&&Jt.push(Jt.length+1);const t=er;return er=Jt[t],Jt[t]=e,t}($t(e,t))},e.wbg.__wbindgen_object_drop_ref=function(e){rr(e)},e.wbg.__wbg_log_1d3ae0273d8f4f8a=function(e){console.log(tr(e))},e.wbg.__wbg_log_576ca876af0d4a77=function(e,t){console.log(tr(e),tr(t))},e.wbg.__wbindgen_throw=function(e,t){throw Error($t(e,t))},e}async function cr(e){if(void 0!==zt)return zt;const t=ur();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:n}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}(await e,t);return function(e,t){return zt=e.exports,cr.__wbindgen_wasm_module=t,sr=null,Qt=null,zt}(r,n)}var Rr,Tr;function pr(t){if(t===e.Format.U8_R_NORM)return"r8unorm";if(t===e.Format.U8_RG_NORM)return"rg8unorm";if(t===e.Format.U8_RGBA_RT)return"bgra8unorm";if(t===e.Format.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(t===e.Format.U8_RGBA_NORM)return"rgba8unorm";if(t===e.Format.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(t===e.Format.S8_R_NORM)return"r8snorm";if(t===e.Format.S8_RG_NORM)return"rg8snorm";if(t===e.Format.S8_RGBA_NORM)return"rgba8snorm";if(t===e.Format.U32_R)return"r32uint";if(t===e.Format.F16_RGBA)return"rgba16float";if(t===e.Format.F32_RGBA)return"rgba32float";if(t===e.Format.D24)return"depth24plus";if(t===e.Format.D24_S8)return"depth24plus-stencil8";if(t===e.Format.D32F)return"depth32float";if(t===e.Format.D32F_S8)return"depth32float-stencil8";if(t===e.Format.BC1)return"bc1-rgba-unorm";if(t===e.Format.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(t===e.Format.BC2)return"bc2-rgba-unorm";if(t===e.Format.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(t===e.Format.BC3)return"bc3-rgba-unorm";if(t===e.Format.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(t===e.Format.BC4_SNORM)return"bc4-r-snorm";if(t===e.Format.BC4_UNORM)return"bc4-r-unorm";if(t===e.Format.BC5_SNORM)return"bc5-rg-snorm";if(t===e.Format.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function Ar(t){if(t===e.TextureDimension.TEXTURE_2D)return"2d";if(t===e.TextureDimension.TEXTURE_CUBE_MAP)return"cube";if(t===e.TextureDimension.TEXTURE_2D_ARRAY)return"2d-array";if(t===e.TextureDimension.TEXTURE_3D)return"3d";throw Error("whoops")}function Fr(t){if(t===e.AddressMode.CLAMP_TO_EDGE)return"clamp-to-edge";if(t===e.AddressMode.REPEAT)return"repeat";if(t===e.AddressMode.MIRRORED_REPEAT)return"mirror-repeat";throw Error("whoops")}function dr(t){if(t===e.FilterMode.BILINEAR)return"linear";if(t===e.FilterMode.POINT)return"nearest";throw Error("whoops")}function fr(t){if(t===e.MipmapFilterMode.LINEAR)return"linear";if(t===e.MipmapFilterMode.NEAREST)return"nearest";if(t===e.MipmapFilterMode.NO_MIP)return"nearest";throw Error("whoops")}function mr(e){return e.gpuBuffer}function hr(t){if(t===e.QueryPoolType.OcclusionConservative)return"occlusion";throw Error("whoops")}function Sr(t){switch(t){case e.PrimitiveTopology.TRIANGLES:return"triangle-list";case e.PrimitiveTopology.POINTS:return"point-list";case e.PrimitiveTopology.TRIANGLE_STRIP:return"triangle-strip";case e.PrimitiveTopology.LINES:return"line-list";case e.PrimitiveTopology.LINE_STRIP:return"line-strip";default:throw Error("Unknown primitive topology mode")}}function gr(t){if(t===e.CullMode.NONE)return"none";if(t===e.CullMode.FRONT)return"front";if(t===e.CullMode.BACK)return"back";throw Error("whoops")}function Nr(t){if(t===e.FrontFace.CCW)return"ccw";if(t===e.FrontFace.CW)return"cw";throw Error("whoops")}function Br(t){if(t===e.BlendFactor.ZERO)return"zero";if(t===e.BlendFactor.ONE)return"one";if(t===e.BlendFactor.SRC)return"src";if(t===e.BlendFactor.ONE_MINUS_SRC)return"one-minus-src";if(t===e.BlendFactor.DST)return"dst";if(t===e.BlendFactor.ONE_MINUS_DST)return"one-minus-dst";if(t===e.BlendFactor.SRC_ALPHA)return"src-alpha";if(t===e.BlendFactor.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(t===e.BlendFactor.DST_ALPHA)return"dst-alpha";if(t===e.BlendFactor.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(t===e.BlendFactor.CONST)return"constant";if(t===e.BlendFactor.ONE_MINUS_CONSTANT)return"one-minus-constant";if(t===e.BlendFactor.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw Error("whoops")}function Cr(t){if(t===e.BlendMode.ADD)return"add";if(t===e.BlendMode.SUBSTRACT)return"subtract";if(t===e.BlendMode.REVERSE_SUBSTRACT)return"reverse-subtract";if(t===e.BlendMode.MIN)return"min";if(t===e.BlendMode.MAX)return"max";throw Error("whoops")}function Lr(e){return{operation:Cr(e.blendMode),srcFactor:Br(e.blendSrcFactor),dstFactor:Br(e.blendDstFactor)}}function Mr(t){return t.blendMode===e.BlendMode.ADD&&t.blendSrcFactor===e.BlendFactor.ONE&&t.blendDstFactor===e.BlendFactor.ZERO}function Or(e){return Mr(e.rgbBlendState)&&Mr(e.alphaBlendState)?void 0:{color:Lr(e.rgbBlendState),alpha:Lr(e.alphaBlendState)}}function Ir(e,t){return t.attachmentsState.map((function(t,r){return function(e,t){return{format:pr(t),blend:Or(e),writeMask:e.channelWriteMask}}(t,e[r])}))}function Ur(t){if(t===e.CompareFunction.NEVER)return"never";if(t===e.CompareFunction.LESS)return"less";if(t===e.CompareFunction.EQUAL)return"equal";if(t===e.CompareFunction.LEQUAL)return"less-equal";if(t===e.CompareFunction.GREATER)return"greater";if(t===e.CompareFunction.NOTEQUAL)return"not-equal";if(t===e.CompareFunction.GEQUAL)return"greater-equal";if(t===e.CompareFunction.ALWAYS)return"always";throw Error("whoops")}function Dr(t){if(t===e.StencilOp.KEEP)return"keep";if(t===e.StencilOp.REPLACE)return"replace";if(t===e.StencilOp.ZERO)return"zero";if(t===e.StencilOp.DECREMENT_CLAMP)return"decrement-clamp";if(t===e.StencilOp.DECREMENT_WRAP)return"decrement-wrap";if(t===e.StencilOp.INCREMENT_CLAMP)return"increment-clamp";if(t===e.StencilOp.INCREMENT_WRAP)return"increment-wrap";if(t===e.StencilOp.INVERT)return"invert";throw Error("whoops")}function Gr(t){if(t===e.VertexStepMode.VERTEX)return"vertex";if(t===e.VertexStepMode.INSTANCE)return"instance";throw Error("whoops")}function Pr(t){if(t===e.Format.U8_R)return"uint8x2";if(t===e.Format.U8_RG)return"uint8x2";if(t===e.Format.U8_RGB)return"uint8x4";if(t===e.Format.U8_RGBA)return"uint8x4";if(t===e.Format.U8_RG_NORM)return"unorm8x2";if(t===e.Format.U8_RGBA_NORM)return"unorm8x4";if(t===e.Format.S8_RGB_NORM)return"snorm8x4";if(t===e.Format.S8_RGBA_NORM)return"snorm8x4";if(t===e.Format.U16_RG_NORM)return"unorm16x2";if(t===e.Format.U16_RGBA_NORM)return"unorm16x4";if(t===e.Format.S16_RG_NORM)return"snorm16x2";if(t===e.Format.S16_RGBA_NORM)return"snorm16x4";if(t===e.Format.S16_RG)return"uint16x2";if(t===e.Format.F16_RG)return"float16x2";if(t===e.Format.F16_RGBA)return"float16x4";if(t===e.Format.F32_R)return"float32";if(t===e.Format.F32_RG)return"float32x2";if(t===e.Format.F32_RGB)return"float32x3";if(t===e.Format.F32_RGBA)return"float32x4";throw"whoops"}function vr(t,r,n,a){switch(void 0===n&&(n=!1),t){case e.Format.S8_R:case e.Format.S8_R_NORM:case e.Format.S8_RG_NORM:case e.Format.S8_RGB_NORM:case e.Format.S8_RGBA_NORM:var o=(ArrayBuffer,new Int8Array(r));return a&&o.set(new Int8Array(a)),o;case e.Format.U8_R:case e.Format.U8_R_NORM:case e.Format.U8_RG:case e.Format.U8_RG_NORM:case e.Format.U8_RGB:case e.Format.U8_RGB_NORM:case e.Format.U8_RGB_SRGB:case e.Format.U8_RGBA:case e.Format.U8_RGBA_NORM:case e.Format.U8_RGBA_SRGB:var i=(ArrayBuffer,new Uint8Array(r));return a&&i.set(new Uint8Array(a)),i;case e.Format.S16_R:case e.Format.S16_RG:case e.Format.S16_RG_NORM:case e.Format.S16_RGB_NORM:case e.Format.S16_RGBA:case e.Format.S16_RGBA_NORM:var s=r instanceof ArrayBuffer?new Int16Array(r):new Int16Array(n?r/2:r);return a&&s.set(new Int16Array(a)),s;case e.Format.U16_R:case e.Format.U16_RGB:case e.Format.U16_RGBA_5551:case e.Format.U16_RGBA_NORM:case e.Format.U16_RG_NORM:case e.Format.U16_R_NORM:var _=r instanceof ArrayBuffer?new Uint16Array(r):new Uint16Array(n?r/2:r);return a&&_.set(new Uint16Array(a)),_;case e.Format.S32_R:var l=r instanceof ArrayBuffer?new Int32Array(r):new Int32Array(n?r/4:r);return a&&l.set(new Int32Array(a)),l;case e.Format.U32_R:case e.Format.U32_RG:var E=r instanceof ArrayBuffer?new Uint32Array(r):new Uint32Array(n?r/4:r);return a&&E.set(new Uint32Array(a)),E;case e.Format.F32_R:case e.Format.F32_RG:case e.Format.F32_RGB:case e.Format.F32_RGBA:var u=r instanceof ArrayBuffer?new Float32Array(r):new Float32Array(n?r/4:r);return a&&u.set(new Float32Array(a)),u}var c=(ArrayBuffer,new Uint8Array(r));return a&&c.set(new Uint8Array(a)),c}!function(e){e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.TEXTURE_BINDING=4]="TEXTURE_BINDING",e[e.STORAGE_BINDING=8]="STORAGE_BINDING",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"}(Rr||(Rr={})),function(e){e[e.READ=1]="READ",e[e.WRITE=2]="WRITE"}(Tr||(Tr={}));var yr=function(e){function t(t){var r=t.id,n=t.device,a=e.call(this)||this;return a.id=r,a.device=n,a}return pe(t,e),t.prototype.destroy=function(){},t}(Tt),br=function(t){function r(r){var n=r.descriptor,a=t.call(this,{id:r.id,device:r.device})||this;a.type=e.ResourceType.Bindings;var o=n.pipeline;y(!!o);var i=n.uniformBufferBindings,s=n.storageBufferBindings,_=n.samplerBindings;a.numUniformBuffers=(null==i?void 0:i.length)||0;var l=[[],[]],E=0;if(s&&s.length)for(var u=0;s.length>u;u++){var c=n.storageBufferBindings[u],R=c.binding,T=c.size,p=c.offset,A={buffer:mr(c.buffer),offset:null!=p?p:0,size:T};l[0].push({binding:null!=R?R:E++,resource:A})}if(i&&i.length)for(u=0;i.length>u;u++){var F=n.uniformBufferBindings[u];R=F.binding,T=F.size,p=F.offset,A={buffer:mr(F.buffer),offset:null!=p?p:0,size:T};l[0].push({binding:null!=R?R:E++,resource:A})}if(_&&_.length){E=0;for(u=0;_.length>u;u++){var d=Ae(Ae({},_[u]),Re),f=null!==(R=n.samplerBindings[u]).texture?R.texture:a.device.getFallbackTexture(d);d.dimension=f.dimension,d.formatKind=v(f.format),l[1].push({binding:E++,resource:f.gpuTextureView});var m=null!==R.sampler?R.sampler:a.device.getFallbackSampler(d),h=m.gpuSampler;l[1].push({binding:E++,resource:h})}}return a.gpuBindGroup=l.filter((function(e){return e.length>0})).map((function(e,t){return a.device.device.createBindGroup({layout:o.getBindGroupLayout(t),entries:e})})),a}return pe(r,t),r}(yr),xr=function(t){function r(r){var n=r.descriptor,a=t.call(this,{id:r.id,device:r.device})||this;a.type=e.ResourceType.Buffer;var o=n.usage,i=n.viewOrSize,s=!!(o&e.BufferUsage.MAP_READ);a.usage=function(t){var r=0;return t&e.BufferUsage.INDEX&&(r|=GPUBufferUsage.INDEX),t&e.BufferUsage.VERTEX&&(r|=GPUBufferUsage.VERTEX),t&e.BufferUsage.UNIFORM&&(r|=GPUBufferUsage.UNIFORM),t&e.BufferUsage.STORAGE&&(r|=GPUBufferUsage.STORAGE),t&e.BufferUsage.COPY_SRC&&(r|=GPUBufferUsage.COPY_SRC),r|GPUBufferUsage.COPY_DST}(o),s&&(a.usage=e.BufferUsage.MAP_READ|e.BufferUsage.COPY_DST);var _=!Le(i);(a.view=Le(i)?null:i,a.size=Le(i)?j(i,4):j(i.byteLength,4),Le(i))?a.gpuBuffer=a.device.device.createBuffer({usage:a.usage,size:a.size,mappedAtCreation:!!s&&_}):(a.gpuBuffer=a.device.device.createBuffer({usage:a.usage,size:a.size,mappedAtCreation:!0}),new(i&&i.constructor||Float32Array)(a.gpuBuffer.getMappedRange()).set(i),a.gpuBuffer.unmap());return a}return pe(r,t),r.prototype.setSubData=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var a=this.gpuBuffer,o=t.byteOffset+r,i=o+(n=Math.min(n=n||t.byteLength,this.size-e)),s=n+3&-4;if(s!==n){var _=new Uint8Array(t.buffer.slice(o,i));(t=new Uint8Array(s)).set(_),r=0,o=0,i=s,n=s}for(var l=15728640,E=0;i-(o+E)>l;)this.device.device.queue.writeBuffer(a,e+E,t.buffer,o+E,l),E+=l;this.device.device.queue.writeBuffer(a,e+E,t.buffer,o+E,n-E)},r.prototype.destroy=function(){t.prototype.destroy.call(this),this.gpuBuffer.destroy()},r}(yr),Xr=function(){function e(){this.commandEncoder=null,this.gpuComputePassEncoder=null}return e.prototype.dispatchWorkgroups=function(e,t,r){this.gpuComputePassEncoder.dispatchWorkgroups(e,t,r)},e.prototype.dispatchWorkgroupsIndirect=function(e,t){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(e.gpuBuffer,t)},e.prototype.finish=function(){return this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.commandEncoder.finish()},e.prototype.beginComputePass=function(){y(null===this.gpuComputePassEncoder),this.gpuComputePassEncoder=this.commandEncoder.beginComputePass(this.gpuComputePassDescriptor)},e.prototype.setPipeline=function(e){var t=b(e.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(t)},e.prototype.setBindings=function(e){this.gpuComputePassEncoder.setBindGroup(0,e.gpuBindGroup[0])},e.prototype.pushDebugGroup=function(e){this.gpuComputePassEncoder.pushDebugGroup(e)},e.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(e){this.gpuComputePassEncoder.insertDebugMarker(e)},e}(),wr=function(t){function r(r){var n=r.descriptor,a=t.call(this,{id:r.id,device:r.device})||this;a.type=e.ResourceType.ComputePipeline,a.gpuComputePipeline=null,a.descriptor=n;var o=n.program.computeStage;if(null===o)return a;var i={layout:"auto",compute:Ae({},o)};return a.gpuComputePipeline=a.device.device.createComputePipeline(i),void 0!==a.name&&(a.gpuComputePipeline.label=a.name),a}return pe(r,t),r.prototype.getBindGroupLayout=function(e){return this.gpuComputePipeline.getBindGroupLayout(e)},r}(yr),Wr=function(t){function r(r){var n,a,o,i,s=r.descriptor,_=t.call(this,{id:r.id,device:r.device})||this;_.type=e.ResourceType.InputLayout;var l=[];try{for(var E=fe(s.vertexBufferDescriptors),u=E.next();!u.done;u=E.next()){var c=u.value,R=c.attributes;l.push({arrayStride:c.arrayStride,stepMode:Gr(c.stepMode),attributes:[]});try{for(var T=(o=void 0,fe(R)),p=T.next();!p.done;p=T.next()){var A=p.value,F=A.offset;l[l.length-1].attributes.push({shaderLocation:A.shaderLocation,format:Pr(A.format),offset:F})}}catch(e){o={error:e}}finally{try{p&&!p.done&&(i=T.return)&&i.call(T)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=E.return)&&a.call(E)}finally{if(n)throw n.error}}return _.indexFormat=function(t){if(null!==t){if(t===e.Format.U16_R)return"uint16";if(t===e.Format.U32_R)return"uint32";throw Error("whoops")}}(s.indexBufferFormat),_.buffers=l,_}return pe(r,t),r}(yr),Hr=function(t){function r(r){var n=r.descriptor,a=t.call(this,{id:r.id,device:r.device})||this;return a.type=e.ResourceType.Program,a.vertexStage=null,a.fragmentStage=null,a.computeStage=null,a.descriptor=n,n.vertex&&(a.vertexStage=a.createShaderStage(n.vertex,"vertex")),n.fragment&&(a.fragmentStage=a.createShaderStage(n.fragment,"fragment")),n.compute&&(a.computeStage=a.createShaderStage(n.compute,"compute")),a}return pe(r,t),r.prototype.setUniformsLegacy=function(e){},r.prototype.createShaderStage=function(e,t){var r,n,a=e.glsl,o=e.entryPoint,i=e.wgsl;if(!i)try{i=this.device.glsl_compile(a,t,!1)}catch(e){throw console.error(e,a),Error("whoops")}var s=function(e){if(!i.includes(e))return"continue";i=(i=i.replace("var T_".concat(e,": texture_2d<f32>;"),"var T_".concat(e,": texture_depth_2d;"))).replace(RegExp("textureSample\\(T_".concat(e,"(.*)\\);$"),"gm"),(function(t,r){return"vec4<f32>(textureSample(T_".concat(e).concat(r,"), 0.0, 0.0, 0.0);")}))};try{for(var _=fe(["u_TextureFramebufferDepth"]),l=_.next();!l.done;l=_.next()){s(l.value)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=_.return)&&n.call(_)}finally{if(r)throw r.error}}return{module:this.device.device.createShaderModule({code:i}),entryPoint:o||"main"}},r}(yr),Vr=function(t){function r(r){var n=r.descriptor,a=t.call(this,{id:r.id,device:r.device})||this;a.type=e.ResourceType.QueryPool;var o=n.elemCount;return a.querySet=a.device.device.createQuerySet({type:hr(n.type),count:o}),a.resolveBuffer=a.device.device.createBuffer({size:8*o,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),a.cpuBuffer=a.device.device.createBuffer({size:8*o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),a.results=null,a}return pe(r,t),r.prototype.queryResultOcclusion=function(e){return null===this.results?null:this.results[e]!==BigInt(0)},r.prototype.destroy=function(){t.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},r}(yr),kr=function(t){function r(r){var n=t.call(this,{id:r.id,device:r.device})||this;return n.type=e.ResourceType.Readback,n}return pe(r,t),r.prototype.readTexture=function(t,r,n,a,o,i,s,_){return void 0===s&&(s=0),Fe(this,void 0,void 0,(function(){var _,l,E,u,c,R;return de(this,(function(T){return 0,l=this.getBlockInformationFromFormat((_=t).gpuTextureformat),c=this.device.createBuffer({usage:e.BufferUsage.STORAGE|e.BufferUsage.MAP_READ|e.BufferUsage.COPY_DST,hint:e.BufferFrequencyHint.STATIC,viewOrSize:u=(E=256*Math.ceil(Math.ceil(a/l.width)*l.length/256))*o}),(R=this.device.device.createCommandEncoder()).copyTextureToBuffer({texture:_.gpuTexture,mipLevel:0,origin:{x:r,y:n,z:0}},{buffer:c.gpuBuffer,offset:0,bytesPerRow:E},{width:a,height:o,depthOrArrayLayers:1}),this.device.device.queue.submit([R.finish()]),[2,this.readBuffer(c,0,i.byteLength===u?i:null,s,u,_.format)]}))}))},r.prototype.readTextureSync=function(e,t,r,n,a,o,i,s){throw Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},r.prototype.readBuffer=function(t,r,n,a,o,i,s,_){var l=this;void 0===r&&(r=0),void 0===n&&(n=null),void 0===o&&(o=0),void 0===i&&(i=e.Format.U8_RGB),void 0===s&&(s=!1);var E=t,u=o||E.size,c=n||E.view,R=c&&c.constructor&&c.constructor.BYTES_PER_ELEMENT||G(i),T=E;if(!(E.usage&e.BufferUsage.MAP_READ&&E.usage&e.BufferUsage.COPY_DST)){var p=this.device.device.createCommandEncoder();T=this.device.createBuffer({usage:e.BufferUsage.STORAGE|e.BufferUsage.MAP_READ|e.BufferUsage.COPY_DST,hint:e.BufferFrequencyHint.STATIC,viewOrSize:u}),p.copyBufferToBuffer(E.gpuBuffer,r,T.gpuBuffer,0,u),this.device.device.queue.submit([p.finish()])}return new Promise((function(e,t){T.gpuBuffer.mapAsync(Tr.READ,r,u).then((function(){var t=T.gpuBuffer.getMappedRange(r,u),n=c;if(s)n=null===n?vr(i,u,!0,t):vr(i,n.buffer,void 0,t);else if(null===n)switch(R){case 1:(n=new Uint8Array(u)).set(new Uint8Array(t));break;case 2:n=l.getHalfFloatAsFloatRGBAArrayBuffer(u/2,t);break;case 4:(n=new Float32Array(u/4)).set(new Float32Array(t))}else switch(R){case 1:(n=new Uint8Array(n.buffer)).set(new Uint8Array(t));break;case 2:n=l.getHalfFloatAsFloatRGBAArrayBuffer(u/2,t,c);break;case 4:var a=c&&c.constructor||Float32Array;(n=new a(n.buffer)).set(new a(t))}T.gpuBuffer.unmap(),e(n)}),(function(e){return t(e)}))}))},r.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(e,t,r){r||(r=new Float32Array(e));for(var n,a,o,i,s=new Uint16Array(t);e--;)r[e]=(a=void 0,o=void 0,i=void 0,a=(32768&(n=s[e]))>>15,i=1023&n,0===(o=(31744&n)>>10)?(a?-1:1)*Math.pow(2,-14)*(i/1024):31==o?i?NaN:1/0*(a?-1:1):(a?-1:1)*Math.pow(2,o-15)*(1+i/1024));return r},r.prototype.getBlockInformationFromFormat=function(e){switch(e){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":case"depth16unorm":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":case"depth32float":default:return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw Error("No fixed size for Stencil8 format!");case"depth24plus":throw Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8}}},r}(yr),Yr=function(){function t(e){this.device=e,this.commandEncoder=null,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return t.prototype.getTextureView=function(e,t){return y(e.mipLevelCount>t),1===e.mipLevelCount?e.gpuTextureView:e.gpuTexture.createView({baseMipLevel:t,mipLevelCount:1})},t.prototype.setRenderPassDescriptor=function(t){var r,n,a,o,i,s;this.descriptor=t,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var _=t.colorAttachment.length;this.gfxColorAttachment.length=_,this.gfxColorResolveTo.length=_;for(var l=0;t.colorAttachment.length>l;l++){var E=t.colorAttachment[l],u=t.colorResolveTo[l];if(null===E&&null!==u&&(E=u,u=null),this.gfxColorAttachment[l]=E,this.gfxColorResolveTo[l]=u,this.gfxColorAttachmentLevel[l]=(null===(r=t.colorAttachmentLevel)||void 0===r?void 0:r[l])||0,this.gfxColorResolveToLevel[l]=(null===(n=t.colorResolveToLevel)||void 0===n?void 0:n[l])||0,null===E){this.gpuColorAttachments.length=l,this.gfxColorAttachment.length=l,this.gfxColorResolveTo.length=l;break}void 0===this.gpuColorAttachments[l]&&(this.gpuColorAttachments[l]={}),(R=this.gpuColorAttachments[l]).view=this.getTextureView(E,(null===(a=this.gfxColorAttachmentLevel)||void 0===a?void 0:a[l])||0);var c=null!==(i=null===(o=t.colorClearColor)||void 0===o?void 0:o[l])&&void 0!==i?i:"load";"load"===c?R.loadOp="load":(R.loadOp="clear",R.clearValue=c),R.storeOp=(null===(s=t.colorStore)||void 0===s?void 0:s[l])?"store":"discard",R.resolveTarget=void 0,null!==u&&(E.sampleCount>1?R.resolveTarget=this.getTextureView(u,this.gfxColorResolveToLevel[l]):R.storeOp="store")}if(this.gfxDepthStencilAttachment=t.depthStencilAttachment,this.gfxDepthStencilResolveTo=t.depthStencilResolveTo,t.depthStencilAttachment){var R,T=t.depthStencilAttachment;(R=this.gpuDepthStencilAttachment).view=T.gpuTextureView,!!(U(T.format)&e.FormatFlags.Depth)?("load"===t.depthClearValue?R.depthLoadOp="load":(R.depthLoadOp="clear",R.depthClearValue=t.depthClearValue),R.depthStoreOp=t.depthStencilStore||null!==this.gfxDepthStencilResolveTo?"store":"discard"):(R.depthLoadOp=void 0,R.depthStoreOp=void 0),!!(U(T.format)&e.FormatFlags.Stencil)?("load"===t.stencilClearValue?R.stencilLoadOp="load":(R.stencilLoadOp="clear",R.stencilClearValue=t.stencilClearValue),R.stencilStoreOp=t.depthStencilStore||null!==this.gfxDepthStencilResolveTo?"store":"discard"):(R.stencilLoadOp=void 0,R.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=ge(t.occlusionQueryPool)?void 0:t.occlusionQueryPool.querySet},t.prototype.beginRenderPass=function(e){y(null===this.gpuRenderPassEncoder),this.setRenderPassDescriptor(e),this.gpuRenderPassEncoder=this.commandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},t.prototype.flipY=function(e,t){return this.device.swapChainHeight-e-t},t.prototype.setViewport=function(e,t,r,n,a,o){void 0===a&&(a=0),void 0===o&&(o=1),this.gpuRenderPassEncoder.setViewport(e,this.flipY(t,n),r,n,a,o)},t.prototype.setScissorRect=function(e,t,r,n){this.gpuRenderPassEncoder.setScissorRect(e,this.flipY(t,n),r,n)},t.prototype.setPipeline=function(e){var t=b(e.gpuRenderPipeline);this.gpuRenderPassEncoder.setPipeline(t)},t.prototype.setVertexInput=function(e,t,r){if(null!==e){var n=e;null!==r&&this.gpuRenderPassEncoder.setIndexBuffer(mr(r.buffer),b(n.indexFormat),r.offset);for(var a=0;t.length>a;a++){var o=t[a];null!==o&&this.gpuRenderPassEncoder.setVertexBuffer(a,mr(o.buffer),o.offset)}}},t.prototype.setBindings=function(e){var t=e;this.gpuRenderPassEncoder.setBindGroup(0,t.gpuBindGroup[0]),t.gpuBindGroup[1]&&this.gpuRenderPassEncoder.setBindGroup(1,t.gpuBindGroup[1])},t.prototype.setStencilReference=function(e){this.gpuRenderPassEncoder.setStencilReference(e)},t.prototype.draw=function(e,t,r,n){this.gpuRenderPassEncoder.draw(e,t,r,n)},t.prototype.drawIndexed=function(e,t,r,n,a){this.gpuRenderPassEncoder.drawIndexed(e,t,r,n,a)},t.prototype.drawIndirect=function(e,t){this.gpuRenderPassEncoder.drawIndirect(mr(e),t)},t.prototype.drawIndexedIndirect=function(e,t){this.gpuRenderPassEncoder.drawIndexedIndirect(mr(e),t)},t.prototype.beginOcclusionQuery=function(e){this.gpuRenderPassEncoder.beginOcclusionQuery(e)},t.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},t.prototype.pushDebugGroup=function(e){this.gpuRenderPassEncoder.pushDebugGroup(e)},t.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},t.prototype.insertDebugMarker=function(e){this.gpuRenderPassEncoder.insertDebugMarker(e)},t.prototype.finish=function(){this.gpuRenderPassEncoder.end(),this.gpuRenderPassEncoder=null;for(var e=0;this.gfxColorAttachment.length>e;e++){var t=this.gfxColorAttachment[e],r=this.gfxColorResolveTo[e];null!==t&&null!==r&&1===t.sampleCount&&this.copyAttachment(r,this.gfxColorAttachmentLevel[e],t,this.gfxColorResolveToLevel[e])}return this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.commandEncoder.finish()},t.prototype.copyAttachment=function(e,t,r,n){y(1===r.sampleCount);var a={texture:r.gpuTexture,mipLevel:n},o={texture:e.gpuTexture,mipLevel:t};y(r.width>>>n==e.width>>>t),y(r.height>>>n==e.height>>>t),y(!!(r.usage&Rr.COPY_SRC)),y(!!(e.usage&Rr.COPY_DST)),this.commandEncoder.copyTextureToTexture(a,o,[e.width,e.height,1])},t}(),Kr=function(t){function r(r){var n=r.descriptor,a=t.call(this,{id:r.id,device:r.device})||this;return a.type=e.ResourceType.RenderPipeline,a.isCreatingAsync=!1,a.gpuRenderPipeline=null,a.descriptor=n,a.device.createRenderPipelineInternal(a,!1),a}return pe(r,t),r.prototype.getBindGroupLayout=function(e){return this.gpuRenderPipeline.getBindGroupLayout(e)},r}(yr),qr=function(t){function r(r){var n,a,o=r.descriptor,i=t.call(this,{id:r.id,device:r.device})||this;i.type=e.ResourceType.Sampler;var s=o.lodMinClamp,_=o.mipmapFilter===e.MipmapFilterMode.NO_MIP?o.lodMinClamp:o.lodMaxClamp,l=null!==(n=o.maxAnisotropy)&&void 0!==n?n:1;return l>1&&y(o.minFilter===e.FilterMode.BILINEAR&&o.magFilter===e.FilterMode.BILINEAR&&o.mipmapFilter===e.MipmapFilterMode.LINEAR),i.gpuSampler=i.device.device.createSampler({addressModeU:Fr(o.addressModeU),addressModeV:Fr(o.addressModeV),addressModeW:Fr(null!==(a=o.addressModeW)&&void 0!==a?a:o.addressModeU),lodMinClamp:s,lodMaxClamp:_,minFilter:dr(o.minFilter),magFilter:dr(o.magFilter),mipmapFilter:fr(o.mipmapFilter),compare:void 0!==o.compareFunction?Ur(o.compareFunction):void 0,maxAnisotropy:l}),i}return pe(r,t),r}(yr),zr=function(t){function r(r){var n=r.descriptor,a=r.skipCreate,o=r.sampleCount,i=t.call(this,{id:r.id,device:r.device})||this;i.type=e.ResourceType.Texture,i.flipY=!1;var s=n.format,_=n.dimension,l=n.width,E=n.height,u=n.depthOrArrayLayers,c=n.mipLevelCount,R=n.usage,T=n.pixelStore;return i.flipY=!!(null==T?void 0:T.unpackFlipY),i.device.createTextureShared({format:s,dimension:null!=_?_:e.TextureDimension.TEXTURE_2D,width:l,height:E,depthOrArrayLayers:null!=u?u:1,mipLevelCount:null!=c?c:1,usage:R,sampleCount:null!=o?o:1},i,a),i}return pe(r,t),r.prototype.textureFromImageBitmapOrCanvas=function(e,t,r){for(var n=t[0].width,a=t[0].height,o={size:{width:n,height:a,depthOrArrayLayers:r},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},i=e.createTexture(o),s=0;t.length>s;s++)e.queue.copyExternalImageToTexture({source:t[s],flipY:this.flipY},{texture:i,origin:[0,0,s]},[n,a]);return[i,n,a]},r.prototype.isImageBitmapOrCanvases=function(e){var t=e[0];return t instanceof ImageBitmap||t instanceof HTMLCanvasElement||t instanceof OffscreenCanvas},r.prototype.isVideo=function(e){return e[0]instanceof HTMLVideoElement},r.prototype.setImageData=function(e,t){var r,n,a,o,i=this,s=this.device.device;this.isImageBitmapOrCanvases(e)?(n=(r=me(this.textureFromImageBitmapOrCanvas(s,e,this.depthOrArrayLayers),3))[0],a=r[1],o=r[2]):this.isVideo(e)?n=s.importExternalTexture({source:e[0]}):e.forEach((function(e){s.queue.writeTexture({texture:i.gpuTexture},e,{},{width:i.width,height:i.height})})),this.width=a,this.height=o,this.gpuTexture=n,this.gpuTextureView=n.createView({dimension:Ar(this.dimension)})},r.prototype.destroy=function(){t.prototype.destroy.call(this),this.gpuTexture.destroy()},r}(yr),Zr=function(){function t(t,r,n,a,o,i){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=Rr.RENDER_ATTACHMENT|Rr.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=e.ViewportOrigin.UPPER_LEFT,this.clipSpaceNearZ=e.ClipSpaceNearZ.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=r,this.canvas=n,this.canvasContext=a,this.glsl_compile=o,this.WGSLComposer=i,this.fallbackTexture2D=this.createFallbackTexture(e.TextureDimension.TEXTURE_2D,e.SamplerFormatKind.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(e.TextureDimension.TEXTURE_2D,e.SamplerFormatKind.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(e.TextureDimension.TEXTURE_2D_ARRAY,e.SamplerFormatKind.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(e.TextureDimension.TEXTURE_3D,e.SamplerFormatKind.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(e.TextureDimension.TEXTURE_CUBE_MAP,e.SamplerFormatKind.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:e.AddressMode.REPEAT,addressModeV:e.AddressMode.REPEAT,minFilter:e.FilterMode.POINT,magFilter:e.FilterMode.POINT,mipmapFilter:e.MipmapFilterMode.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:e.AddressMode.REPEAT,addressModeV:e.AddressMode.REPEAT,minFilter:e.FilterMode.POINT,magFilter:e.FilterMode.POINT,mipmapFilter:e.MipmapFilterMode.NEAREST,compareFunction:e.CompareFunction.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(e){console.error(e.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return t.prototype.destroy=function(){},t.prototype.configureSwapChain=function(e,t){this.swapChainWidth===e&&this.swapChainHeight===t||(this.swapChainWidth=e,this.swapChainHeight=t)},t.prototype.getOnscreenTexture=function(){var t=this.canvasContext.getCurrentTexture(),r=t.createView(),n=new zr({id:0,device:this,descriptor:{format:e.Format.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:e.TextureDimension.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return n.depthOrArrayLayers=1,n.sampleCount=1,n.gpuTexture=t,n.gpuTextureView=r,n.name="Onscreen",this.setResourceName(n,"Onscreen Texture"),n},t.prototype.getDevice=function(){return this},t.prototype.getCanvas=function(){return this.canvas},t.prototype.beginFrame=function(){},t.prototype.endFrame=function(){},t.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},t.prototype.createBuffer=function(e){return new xr({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createTexture=function(e){return new zr({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createSampler=function(e){return new qr({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderTarget=function(t){var r=new zr({id:this.getNextUniqueId(),device:this,descriptor:Ae(Ae({},t),{dimension:e.TextureDimension.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:e.TextureUsage.RENDER_TARGET}),sampleCount:t.sampleCount});return r.depthOrArrayLayers=1,r.type=e.ResourceType.RenderTarget,r},t.prototype.createRenderTargetFromTexture=function(t){var r=t.format,n=t.width,a=t.height,o=t.depthOrArrayLayers,i=t.sampleCount,s=t.mipLevelCount,_=t.gpuTexture,l=t.gpuTextureView,E=t.usage;y(!!(E&Rr.RENDER_ATTACHMENT));var u=new zr({id:this.getNextUniqueId(),device:this,descriptor:{format:r,width:n,height:a,depthOrArrayLayers:o,dimension:e.TextureDimension.TEXTURE_2D,mipLevelCount:s,usage:E},skipCreate:!0});return u.depthOrArrayLayers=o,u.sampleCount=i,u.gpuTexture=_,u.gpuTextureView=l,u},t.prototype.createProgram=function(e){var t,r;return(null===(t=e.vertex)||void 0===t?void 0:t.glsl)&&(e.vertex.glsl=ut(this.queryVendorInfo(),"vert",e.vertex.glsl)),(null===(r=e.fragment)||void 0===r?void 0:r.glsl)&&(e.fragment.glsl=ut(this.queryVendorInfo(),"frag",e.fragment.glsl)),new Hr({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createProgramSimple=function(e){return new Hr({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createTextureShared=function(t,r,n){var a={width:t.width,height:t.height,depthOrArrayLayers:t.depthOrArrayLayers},o=t.mipLevelCount,i=pr(t.format),s=function(t){if(t===e.TextureDimension.TEXTURE_2D)return"2d";if(t===e.TextureDimension.TEXTURE_CUBE_MAP)return"2d";if(t===e.TextureDimension.TEXTURE_2D_ARRAY)return"2d";if(t===e.TextureDimension.TEXTURE_3D)return"3d";throw Error("whoops")}(t.dimension),_=function(t){var r=0;return t&e.TextureUsage.SAMPLED&&(r|=Rr.TEXTURE_BINDING|Rr.COPY_DST),t&e.TextureUsage.RENDER_TARGET&&(r|=Rr.RENDER_ATTACHMENT|Rr.TEXTURE_BINDING|Rr.COPY_SRC|Rr.COPY_DST),r}(t.usage);if(r.gpuTextureformat=i,r.dimension=t.dimension,r.format=t.format,r.width=t.width,r.height=t.height,r.depthOrArrayLayers=t.depthOrArrayLayers,r.mipLevelCount=o,r.usage=_,r.sampleCount=t.sampleCount,!n){var l=this.device.createTexture({size:a,mipLevelCount:o,format:i,dimension:s,sampleCount:t.sampleCount,usage:_}),E=l.createView();r.gpuTexture=l,r.gpuTextureView=E}},t.prototype.getFallbackSampler=function(t){return t.formatKind===e.SamplerFormatKind.Depth&&t.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},t.prototype.getFallbackTexture=function(t){var r=t.dimension;if(r===e.TextureDimension.TEXTURE_2D)return t.formatKind===e.SamplerFormatKind.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===e.TextureDimension.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===e.TextureDimension.TEXTURE_3D)return this.fallbackTexture3D;if(r===e.TextureDimension.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw Error("whoops")},t.prototype.createFallbackTexture=function(t,r){return this.createTexture({dimension:t,format:r===e.SamplerFormatKind.Float?e.Format.U8_RGBA_NORM:e.Format.D24,usage:e.TextureUsage.SAMPLED,width:1,height:1,depthOrArrayLayers:t===e.TextureDimension.TEXTURE_CUBE_MAP?6:1,mipLevelCount:1})},t.prototype.createBindings=function(e){return new br({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createInputLayout=function(e){return new Wr({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createComputePipeline=function(e){return new wr({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderPipeline=function(e){return new Kr({id:this.getNextUniqueId(),device:this,descriptor:Ae({},e)})},t.prototype.createQueryPool=function(e,t){return new Vr({id:this.getNextUniqueId(),device:this,descriptor:{type:e,elemCount:t}})},t.prototype.createRenderPipelineInternal=function(t,r){var n;if(null===t.gpuRenderPipeline){var a=t.descriptor,o=a.program,i=o.vertexStage,s=o.fragmentStage;if(null!==i&&null!==s){var _=a.megaStateDescriptor||{},l=_.stencilBack,E=_.stencilFront,u=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);n.length>a;a++)0>t.indexOf(n[a])&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(_,["stencilBack","stencilFront"]),c=se(Ee);a.megaStateDescriptor=Ae(Ae(Ae({},c),{stencilBack:Ae(Ae({},c.stencilBack),l),stencilFront:Ae(Ae({},c.stencilFront),E)}),u);var R=a.megaStateDescriptor.attachmentsState[0];a.colorAttachmentFormats.forEach((function(e,t){a.megaStateDescriptor.attachmentsState[t]||(a.megaStateDescriptor.attachmentsState[t]=ae(void 0,R))}));var T,p,A=(T=null!==(n=a.topology)&&void 0!==n?n:e.PrimitiveTopology.TRIANGLES,p=a.megaStateDescriptor,{topology:Sr(T),cullMode:gr(p.cullMode),frontFace:Nr(p.frontFace)}),F=Ir(a.colorAttachmentFormats,a.megaStateDescriptor),d=function(e,t){if(!ge(e))return{format:pr(e),depthWriteEnabled:!!t.depthWrite,depthCompare:Ur(t.depthCompare),depthBias:t.polygonOffset?1:0,depthBiasSlopeScale:t.polygonOffset?1:0,stencilFront:{compare:Ur(t.stencilFront.compare),passOp:Dr(t.stencilFront.passOp),failOp:Dr(t.stencilFront.failOp),depthFailOp:Dr(t.stencilFront.depthFailOp)},stencilBack:{compare:Ur(t.stencilBack.compare),passOp:Dr(t.stencilBack.passOp),failOp:Dr(t.stencilBack.failOp),depthFailOp:Dr(t.stencilBack.depthFailOp)},stencilReadMask:1,stencilWriteMask:1}}(a.depthStencilAttachmentFormat,a.megaStateDescriptor),f=void 0;null!==a.inputLayout&&(f=a.inputLayout.buffers);var m=a.sampleCount,h={layout:"auto",vertex:Ae(Ae({},i),{buffers:f}),primitive:A,depthStencil:d,multisample:{count:m},fragment:Ae(Ae({},s),{targets:F})};t.gpuRenderPipeline=this.device.createRenderPipeline(h)}}},t.prototype.createReadback=function(){return new kr({id:this.getNextUniqueId(),device:this})},t.prototype.createRenderPass=function(e){var t=this.renderPassPool.pop();return void 0===t&&(t=new Yr(this)),t.commandEncoder=this.device.createCommandEncoder(),t.beginRenderPass(e),t},t.prototype.createComputePass=function(){var e=this.computePassPool.pop();return void 0===e&&(e=new Xr),e.commandEncoder=this.device.createCommandEncoder(),e.beginComputePass(),e},t.prototype.submitPass=function(e){var t=this.device.queue,r=e,n=r.finish();t.submit([n]),r.commandEncoder=null},t.prototype.copySubTexture2D=function(e,t,r,n,a,o){var i=this.device.createCommandEncoder(),s=e,_=n,l={texture:_.gpuTexture,origin:[a,o,0]},E={texture:s.gpuTexture,origin:[t,r,0]};y(!!(_.usage&Rr.COPY_SRC)),y(!!(s.usage&Rr.COPY_DST)),i.copyTextureToTexture(l,E,[_.width,_.height,1]),this.device.queue.submit([i.finish()])},t.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},t.prototype.queryTextureFormatSupported=function(t,r,n){if(function(t){switch(I(t)){case e.FormatTypeFlags.BC1:case e.FormatTypeFlags.BC2:case e.FormatTypeFlags.BC3:case e.FormatTypeFlags.BC4_SNORM:case e.FormatTypeFlags.BC4_UNORM:case e.FormatTypeFlags.BC5_SNORM:case e.FormatTypeFlags.BC5_UNORM:return!0;default:return!1}}(t)){if(!this.featureTextureCompressionBC)return!1;var a=function(t){switch(I(t)){case e.FormatTypeFlags.BC1:case e.FormatTypeFlags.BC2:case e.FormatTypeFlags.BC3:case e.FormatTypeFlags.BC4_SNORM:case e.FormatTypeFlags.BC4_UNORM:case e.FormatTypeFlags.BC5_SNORM:case e.FormatTypeFlags.BC5_UNORM:return 4;default:return 1}}(t);return r%a==0&&n%a==0&&this.featureTextureCompressionBC}switch(t){case e.Format.U16_RGBA_NORM:case e.Format.F32_RGBA:return!1}return!0},t.prototype.queryPlatformAvailable=function(){return!0},t.prototype.queryVendorInfo=function(){return this},t.prototype.queryRenderPass=function(e){return e.descriptor},t.prototype.queryRenderTarget=function(e){return e},t.prototype.setResourceName=function(t,r){if(t.name=r,t.type===e.ResourceType.Buffer)(n=t).gpuBuffer.label=r;else if(t.type===e.ResourceType.Texture){(n=t).gpuTexture.label=r,n.gpuTextureView.label=r}else if(t.type===e.ResourceType.RenderTarget){(n=t).gpuTexture.label=r,n.gpuTextureView.label=r}else if(t.type===e.ResourceType.Sampler){(n=t).gpuSampler.label=r}else if(t.type===e.ResourceType.RenderPipeline){var n;null!==(n=t).gpuRenderPipeline&&(n.gpuRenderPipeline.label=r)}},t.prototype.setResourceLeakCheck=function(e,t){},t.prototype.checkForLeaks=function(){},t.prototype.programPatched=function(e){},t.prototype.pipelineQueryReady=function(e){return null!==e.gpuRenderPipeline},t.prototype.pipelineForceReady=function(e){this.createRenderPipelineInternal(e,!1)},t}(),Qr=function(){function e(e){this.pluginOptions=e}return e.prototype.createSwapChain=function(e){return Fe(this,void 0,void 0,(function(){var t,r,n,a,o,i;return de(this,(function(s){switch(s.label){case 0:if(void 0===globalThis.navigator.gpu)return[2,null];t=null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:this.pluginOptions.xrCompatible})];case 2:return t=s.sent(),[3,4];case 3:return r=s.sent(),console.log(r),[3,4];case 4:return null===t?[2,null]:(n=["depth32float-stencil8","texture-compression-bc"].filter((function(e){return t.features.has(e)})),[4,t.requestDevice({requiredFeatures:n})]);case 5:if((a=s.sent())&&(o=this.pluginOptions.onContextLost,a.lost.then((function(){o&&o()}))),null===a)return[2,null];if(!(i=e.getContext("webgpu")))return[2,null];s.label=6;case 6:return s.trys.push([6,8,,9]),[4,cr(this.pluginOptions.shaderCompilerPath)];case 7:case 8:return s.sent(),[3,9];case 9:return[2,new Zr(t,a,e,i,lr,Er&&new Er)]}}))}))},e}();e.IsDepthReversed=K,e.OpaqueBlack=V,e.OpaqueWhite=Y,e.TransparentBlack=H,e.TransparentWhite=k,e.UNIFORM_SETTERS=nt,e.WebGLDeviceContribution=qt,e.WebGPUDeviceContribution=Qr,e.align=j,e.alignNonPowerOfTwo=function(e,t){return((e+t-1)/t|0)*t},e.arrayCopy=Oe,e.arrayEqual=Me,e.assert=y,e.assertExists=b,e.bindingsDescriptorCopy=function(e){return{samplerBindings:e.samplerBindings&&Oe(e.samplerBindings,Xe),uniformBufferBindings:e.uniformBufferBindings&&Oe(e.uniformBufferBindings,we),storageBufferBindings:e.storageBufferBindings&&Oe(e.storageBufferBindings,we),pipeline:e.pipeline}},e.bindingsDescriptorEquals=function(e,t){return e.samplerBindings=e.samplerBindings||[],e.uniformBufferBindings=e.uniformBufferBindings||[],t.samplerBindings=t.samplerBindings||[],t.uniformBufferBindings=t.uniformBufferBindings||[],e.samplerBindings.length===t.samplerBindings.length&&(!!Me(e.samplerBindings,t.samplerBindings,Ue)&&!!Me(e.uniformBufferBindings,t.uniformBufferBindings,Ie))},e.bisectRight=$,e.bufferBindingCopy=we,e.colorCopy=X,e.colorEqual=x,e.colorNewCopy=w,e.colorNewFromRGBA=W,e.compareDepthValues=function(t,r,n,a){if(void 0===a&&(a=K),(n=q(n,a))===e.CompareFunction.LESS)return r>t;if(n===e.CompareFunction.LEQUAL)return r>=t;if(n===e.CompareFunction.GREATER)return t>r;if(n===e.CompareFunction.GEQUAL)return t>=r;throw Error("whoops")},e.copyAttachmentState=ae,e.copyAttachmentStateFromSimple=_e,e.copyMegaState=se,e.copyStencilFaceState=ne,e.defaultBindingLayoutSamplerDescriptor=Re,e.defaultMegaState=Ee,e.fallbackUndefined=Z,e.fillArray=function(e,t,r){e.length=t,e.fill(r)},e.fullscreenMegaState=ce,e.getAttributeLocations=lt,e.getDefines=_t,e.getFormatByteSize=P,e.getFormatCompByteSize=G,e.getFormatCompFlags=O,e.getFormatCompFlagsComponentCount=L,e.getFormatComponentCount=function(e){return O(e)},e.getFormatFlags=U,e.getFormatSamplerKind=v,e.getFormatTypeFlags=I,e.getFormatTypeFlagsByteSize=D,e.getUniformSetter=at,e.getUniforms=function(e){var t=[],r=[];return e.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,(function(e,t,n){var a=[];return n.trim().replace("\r\n","\n").split("\n").forEach((function(e){var t=me(e.trim().split(/\s+/),2),r=t[1];a.push({type:t[0].trim(),name:r.replace(";","").trim()})})),r.push({type:t.trim(),uniforms:a}),""})),e.replace(/\s*uniform(?:\s+)(?:\w+)(?:\s?){([^]*?)};?/g,(function(e,n){return n.trim().replace("\r\n","\n").split("\n").forEach((function(e){var n=e.trim().split(" "),a=n[0]||"",o=n[1]||"",i=o.indexOf("[")>-1;if(o=o.replace(";","").replace("[","").trim(),!a.startsWith("#")){if(a){var s=r.find((function(e){return a===e.type}));if(s)if(i)for(var _=function(e){s.uniforms.forEach((function(r){t.push("".concat(o,"[").concat(e,"].").concat(r.name))}))},l=0;5>l;l++)_(l);else s.uniforms.forEach((function(e){t.push("".concat(o,".").concat(e.name))}))}o&&t.push(o)}})),""})),t},e.inputLayoutBufferDescriptorCopy=He,e.inputLayoutBufferDescriptorEquals=xe,e.inputLayoutDescriptorCopy=function(e){return{vertexBufferDescriptors:Oe(e.vertexBufferDescriptors,He),indexBufferFormat:e.indexBufferFormat,program:e.program}},e.inputLayoutDescriptorEquals=function(e,t){return e.indexBufferFormat===t.indexBufferFormat&&(!!Me(e.vertexBufferDescriptors,t.vertexBufferDescriptors,xe)&&!!ve(e.program,t.program))},e.isPowerOfTwo=z,e.isTypedArray=it,e.leftPad=te,e.makeFormat=M,e.makeMegaState=ue,e.makeTextureDescriptor2D=function(t,r,n,a){return{dimension:e.TextureDimension.TEXTURE_2D,format:t,width:r,height:n,depthOrArrayLayers:1,mipLevelCount:a,usage:e.TextureUsage.SAMPLED}},e.nArray=J,e.nullify=Q,e.parseUniformName=ke,e.prependLineNo=ee,e.preprocessProgram_GLSL=function(e,t,r,n){return void 0===n&&(n=null),{vert:t,frag:r,preprocessedVert:ut(e,"vert",t,n),preprocessedFrag:ut(e,"frag",r,n)}},e.preprocessShader_GLSL=ut,e.range=function(e,t){for(var r=[],n=e;e+t>n;n++)r.push(n);return r},e.renderPipelineDescriptorCopy=function(e){var t=e.program,r=e.topology;return{inputLayout:e.inputLayout,megaStateDescriptor:e.megaStateDescriptor&&se(e.megaStateDescriptor),program:t,topology:r,colorAttachmentFormats:e.colorAttachmentFormats.slice(),depthStencilAttachmentFormat:e.depthStencilAttachmentFormat,sampleCount:e.sampleCount}},e.renderPipelineDescriptorEquals=function(e,t){return e.topology===t.topology&&(e.inputLayout===t.inputLayout&&(e.sampleCount===t.sampleCount&&(!(e.megaStateDescriptor&&t.megaStateDescriptor&&!function(e,t){return!(!Me(e.attachmentsState,t.attachmentsState,Ge)||e.blendConstant&&t.blendConstant&&!x(e.blendConstant,t.blendConstant)||e.stencilFront&&t.stencilFront&&!Pe(e.stencilFront,t.stencilFront)||e.stencilBack&&t.stencilBack&&!Pe(e.stencilBack,t.stencilBack)||e.depthCompare!==t.depthCompare||e.depthWrite!==t.depthWrite||e.stencilWrite!==t.stencilWrite||e.cullMode!==t.cullMode||e.frontFace!==t.frontFace||e.polygonOffset!==t.polygonOffset)}(e.megaStateDescriptor,t.megaStateDescriptor))&&(!!ve(e.program,t.program)&&(!!Me(e.colorAttachmentFormats,t.colorAttachmentFormats,ye)&&e.depthStencilAttachmentFormat===t.depthStencilAttachmentFormat)))))},e.reverseDepthForClearValue=function(e,t){return void 0===t&&(t=K),t?1-e:e},e.reverseDepthForCompareFunction=q,e.reverseDepthForDepthOffset=function(e,t){return void 0===t&&(t=K),t?-e:e},e.reverseDepthForOrthographicProjectionMatrix=function(e,t){void 0===t&&(t=K),t&&(e[10]=-e[10],e[14]=1-e[14])},e.reverseDepthForPerspectiveProjectionMatrix=function(e,t){void 0===t&&(t=K),t&&(e[10]=-e[10],e[14]=-e[14])},e.samplerBindingCopy=Xe,e.samplerDescriptorEquals=function(e,t){return e.addressModeU===t.addressModeU&&e.addressModeV===t.addressModeV&&e.minFilter===t.minFilter&&e.magFilter===t.magFilter&&e.mipmapFilter===t.mipmapFilter&&e.lodMinClamp===t.lodMinClamp&&e.lodMaxClamp===t.lodMaxClamp&&e.maxAnisotropy===t.maxAnisotropy&&e.compareFunction===t.compareFunction},e.setAttachmentStateSimple=function(e,t){return void 0===e.attachmentsState&&(e.attachmentsState=[],oe(e.attachmentsState,Ee.attachmentsState)),_e(e.attachmentsState[0],t),e},e.setBitFlagEnabled=function(e,t,r){return r?e|=t:e&=~t,e},e.setFormatComponentCount=function(e,t){return 4294902015&e|t<<8},e.setFormatFlags=function(e,t){return 4294967040&e|t},e.setMegaStateFlags=ie,e.spliceBisectRight=function(e,t,r){var n=$(e,t,r);e.splice(n,0,t)},e.stencilFaceStateEquals=Pe,e.vertexAttributeDescriptorCopy=We,e.vertexAttributeDescriptorEquals=be}));
//# sourceMappingURL=index.umd.min.js.map
